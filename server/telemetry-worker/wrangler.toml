name = "helixscreen-telemetry"
main = "src/index.ts"
compatibility_date = "2024-09-23"

[[r2_buckets]]
binding = "TELEMETRY_BUCKET"
bucket_name = "helixscreen-telemetry"
jurisdiction = "eu"

[[analytics_engine_datasets]]
binding = "TELEMETRY_ANALYTICS"
dataset = "helixscreen_telemetry"

[vars]
CLOUDFLARE_ACCOUNT_ID = "4f3ea9194c32f9ce44bc77916411315e"

[[routes]]
pattern = "telemetry.helixscreen.org/*"
zone_name = "helixscreen.org"

# Rate limiting: 10 ingest requests per IP per 60 seconds
# Each request batches up to 20 events, so 200 events/min per IP is plenty
[[ratelimits]]
name = "INGEST_LIMITER"
namespace_id = "1001"
[ratelimits.simple]
limit = 10
period = 60
