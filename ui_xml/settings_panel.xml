<?xml version="1.0"?>
<!-- Copyright (C) 2025-2026 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<!-- Settings Panel - Enhanced Scrolling List Design -->
<!-- Comprehensive settings organized in sections with icons: Appearance, Printer, Notifications, System, About -->
<!-- All styling controlled via XML - C++ only updates subjects and handles callbacks -->
<component>
  <view name="settings_panel"
        extends="lv_obj" width="100%" height="100%" style_bg_opa="0" style_border_width="0" style_pad_all="0"
        style_pad_gap="0" flex_flow="column" scrollable="true" scroll_dir="ver" style_bg_color="#app_bg_color">
    <!-- ================================================================== -->
    <!-- APPEARANCE SECTION -->
    <!-- ================================================================== -->
    <setting_section_header title="APPEARANCE" icon="light"/>
    <!-- Animations Toggle -->
    <setting_toggle_row name="row_animations"
                        label="Animations" icon="animation" description="Enable UI motion effects"
                        callback="on_animations_changed"/>
    <!-- 3D Preview Toggle -->
    <setting_toggle_row name="row_gcode_3d"
                        label="3D Preview" icon="rotate_3d" description="Interactive 3D G-code during prints"
                        callback="on_gcode_3d_changed"/>
    <!-- Display Settings (opens overlay for brightness + sleep timeout) -->
    <setting_action_row name="row_display_settings"
                        label="Display Settings" icon="light" description="Brightness and screen timeout"
                        callback="on_display_settings_clicked"/>
    <!-- ================================================================== -->
    <!-- PRINTER SECTION -->
    <!-- ================================================================== -->
    <setting_section_header title="PRINTER" icon="printer_3d"/>
    <!-- Filament Sensors (hidden if no sensors detected) -->
    <lv_obj name="container_filament_sensors"
            width="100%" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false">
      <bind_flag_if_eq subject="filament_sensor_count" flag="hidden" ref_value="0"/>
      <setting_action_row name="row_filament_sensors"
                          label="Filament Sensors" icon="filament" description="Configure filament detection sensors"
                          callback="on_filament_sensors_clicked"/>
    </lv_obj>
    <!-- LED Light Toggle (hidden if no LED capability) -->
    <lv_obj name="container_led_light"
            width="100%" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false">
      <bind_flag_if_eq subject="printer_has_led" flag="hidden" ref_value="0"/>
      <setting_toggle_row name="row_led_light"
                          label="LED Light" icon="light" description="Toggle printer LED strip"
                          callback="on_led_light_changed"/>
    </lv_obj>
    <!-- Firmware Retraction Settings (hidden if no firmware_retraction capability) -->
    <lv_obj name="container_firmware_retraction"
            width="100%" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false">
      <bind_flag_if_eq subject="printer_has_firmware_retraction" flag="hidden" ref_value="0"/>
      <setting_action_row name="row_firmware_retraction"
                          label="Retraction Settings" icon="arrow_up_right"
                          description="Configure G10/G11 firmware retraction" callback="on_retraction_row_clicked"/>
    </lv_obj>
    <!-- E-Stop Confirmation Toggle -->
    <setting_toggle_row name="row_estop_confirm"
                        label="E-Stop Confirmation" icon="alert_octagon"
                        description="Require confirmation before emergency stop" callback="on_estop_confirm_changed"/>
    <!-- Macro Buttons (opens overlay for configuring quick buttons and standard macros) -->
    <setting_action_row name="row_macro_buttons"
                        label="Macro Buttons" icon="script_text"
                        description="Configure quick buttons and standard macros" callback="on_macro_buttons_clicked"/>
    <!-- ================================================================== -->
    <!-- NOTIFICATIONS SECTION -->
    <!-- ================================================================== -->
    <setting_section_header title="NOTIFICATIONS" icon="notifications"/>
    <!-- Sounds Toggle (hidden if no speaker capability) -->
    <lv_obj name="container_sounds"
            width="100%" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false">
      <bind_flag_if_eq subject="printer_has_speaker" flag="hidden" ref_value="0"/>
      <setting_toggle_row name="row_sounds"
                          label="Sounds" icon="notifications" description="Enable audio feedback"
                          callback="on_sounds_changed"/>
    </lv_obj>
    <!-- Completion Alert Dropdown (Off/Notification/Alert) -->
    <setting_dropdown_row name="row_completion_alert"
                          label="Print Completion Alert" icon="notifications" description="Notify when print finishes"
                          callback="on_completion_alert_changed"/>
    <!-- ================================================================== -->
    <!-- MOTION SECTION -->
    <!-- ================================================================== -->
    <setting_section_header title="MOTION" icon="speed"/>
    <!-- Machine Limits -->
    <setting_action_row name="row_machine_limits"
                        label="Machine Limits" icon="dashboard" description="Velocity and acceleration limits"
                        callback="on_machine_limits_clicked"/>
    <!-- ================================================================== -->
    <!-- SYSTEM SECTION -->
    <!-- ================================================================== -->
    <setting_section_header title="SYSTEM" icon="sysinfo"/>
    <!-- Network Settings -->
    <setting_action_row name="row_network"
                        label="Network Settings" icon="wifi" description="WiFi and Ethernet configuration"
                        callback="on_network_clicked"/>
    <!-- Touch Calibration -->
    <setting_action_row name="row_touch_calibration"
                        label="Touch Calibration" icon="cursor_move" description="Calibrate touchscreen input"
                        callback="on_touch_calibration_clicked"/>
    <!-- Hardware Issues (hidden when no issues) -->
    <lv_obj name="container_hardware_health"
            width="100%" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" scrollable="false">
      <bind_flag_if_eq subject="hardware_has_issues" flag="hidden" ref_value="0"/>
      <!-- Label bound to hardware_issues_label subject in C++ for reactive updates -->
      <setting_action_row name="row_hardware_health"
                          label="Hardware Issues" icon="alert" description="Review detected hardware validation issues"
                          callback="on_hardware_health_clicked"/>
    </lv_obj>
    <!-- Factory Reset -->
    <setting_action_row name="row_factory_reset"
                        label="Factory Reset" icon="refresh" description="Reset all settings and restart wizard"
                        callback="on_factory_reset_clicked"/>
    <!-- Plugins -->
    <setting_action_row name="row_plugins"
                        label="Plugins" icon="puzzle_outline" description="View installed plugins and status"
                        callback="on_plugins_clicked"/>
    <!-- ================================================================== -->
    <!-- ABOUT SECTION -->
    <!-- ================================================================== -->
    <setting_section_header title="ABOUT" icon="info"/>
    <!-- Version Info - lv_button for native press feedback (7-tap secret to enable memory debug) -->
    <lv_button name="row_version"
               width="100%" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0"
               style_shadow_width="0" style_radius="0" scrollable="false">
      <lv_obj width="100%"
              height="content" flex_flow="row" style_flex_main_place="start" style_flex_cross_place="center"
              style_bg_opa="0" style_border_width="0" style_pad_left="#space_lg" style_pad_right="#space_lg"
              style_pad_top="#space_md" style_pad_bottom="#space_md" style_pad_gap="#space_sm" scrollable="false"
              clickable="false" event_bubble="true">
        <icon name="row_icon" src="info" size="sm" variant="secondary" clickable="false" event_bubble="true"/>
        <text_body name="label"
                   text="Version" style_text_color="#text_primary" flex_grow="1" clickable="false" event_bubble="true"/>
        <text_body name="value"
                   bind_text="version_value" style_text_color="#text_secondary" clickable="false" event_bubble="true"/>
      </lv_obj>
      <event_cb trigger="clicked" callback="on_version_clicked"/>
    </lv_button>
    <!-- Printer Name -->
    <setting_info_row name="row_printer" label="Printer" icon="printer_3d">
      <!-- Bind value to subject for reactive updates -->
      <text_body name="value" bind_text="printer_value" style_text_color="#text_secondary"/>
    </setting_info_row>
    <!-- Klipper Version -->
    <setting_info_row name="row_klipper" label="Klipper" icon="toy_brick_outline" value="—"/>
    <!-- Moonraker Version -->
    <setting_info_row name="row_moonraker" label="Moonraker" icon="toy_brick_outline" value="—"/>
    <!-- Bottom padding for scroll -->
    <lv_obj width="100%" height="#space_lg" style_bg_opa="0" style_border_width="0" scrollable="false"/>
  </view>
</component>
