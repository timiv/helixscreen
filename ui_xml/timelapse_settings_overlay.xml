<?xml version="1.0"?>
<!-- Copyright (C) 2025-2026 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<!-- Timelapse Settings Overlay Panel -->
<!-- Configure Moonraker-Timelapse plugin settings for recording prints -->
<component>
  <!-- overlay_bg is a theme-aware pair defined in globals.xml -->
  <view name="timelapse_settings_overlay"
        extends="overlay_panel" width="#overlay_panel_width_full" title="Timelapse Settings" title_tag="Timelapse Settings" bg_color="#screen_bg">
    <!-- Content Area - no padding, rows handle their own -->
    <lv_obj name="overlay_content"
            width="100%" flex_grow="1" style_pad_top="0" style_pad_left="#space_lg" style_pad_right="#space_lg" style_pad_bottom="#space_lg" scrollable="true" flex_flow="column">
      <!-- ================================================================== -->
      <!-- ENABLE TIMELAPSE -->
      <!-- ================================================================== -->
      <setting_toggle_row name="row_timelapse_enable"
                          label="Enable Timelapse" label_tag="Enable Timelapse" icon="video" description="Record timelapses of your prints" description_tag="Record timelapses of your prints"
                          callback="on_timelapse_enabled_changed"/>
      <!-- ================================================================== -->
      <!-- RECORDING MODE -->
      <!-- ================================================================== -->
      <setting_dropdown_row name="row_timelapse_mode"
                            label="Recording Mode" label_tag="Recording Mode" icon="layers"
                            description="Choose how frames are captured during printing" description_tag="Choose how frames are captured during printing" options="Layer&#10;Hyperlapse"
                            callback="on_timelapse_mode_changed"/>
      <!-- Mode info box -->
      <lv_obj name="mode_info_container"
              width="100%" height="content" style_bg_color="#overlay_bg" style_radius="#border_radius"
              style_pad_all="#space_md" scrollable="false" flex_flow="column" style_pad_gap="#space_xs"
              style_margin_left="#space_lg" style_margin_right="#space_lg" style_margin_bottom="#space_md">
        <text_small name="mode_info_text"
                    width="100%" text="Layer mode captures one frame per layer change. Best for most prints." translation_tag="Layer mode captures one frame per layer change. Best for most prints."
                    style_text_color="#text_muted" long_mode="wrap"/>
      </lv_obj>
      <!-- ================================================================== -->
      <!-- FRAMERATE -->
      <!-- ================================================================== -->
      <setting_dropdown_row name="row_timelapse_framerate"
                            label="Framerate" label_tag="Framerate" icon="animation_play" description="Video playback speed" description_tag="Video playback speed"
                            options="15 fps&#10;24 fps&#10;30 fps&#10;60 fps" callback="on_timelapse_framerate_changed"/>
      <!-- ================================================================== -->
      <!-- AUTO-RENDER -->
      <!-- ================================================================== -->
      <setting_toggle_row name="row_timelapse_autorender"
                          label="Auto-render video" label_tag="Auto-render video" icon="play_circle" description="Create video when print completes" description_tag="Create video when print completes"
                          callback="on_timelapse_autorender_changed"/>
      <!-- ================================================================== -->
      <!-- RENDER NOW -->
      <!-- ================================================================== -->
      <lv_obj name="render_section"
              width="100%" height="content" scrollable="false" flex_flow="column"
              style_pad_top="#space_md" style_pad_bottom="#space_sm">
        <!-- Frame count display -->
        <lv_obj width="100%" height="content" scrollable="false" flex_flow="row"
                style_flex_cross_place="center" style_pad_gap="#space_sm"
                style_pad_left="#space_lg" style_pad_right="#space_lg" style_pad_bottom="#space_sm">
          <icon src="camera" size="xs" variant="secondary"/>
          <text_small name="frame_count_label" bind_text="timelapse_frame_count" width="content"/>
          <text_small text=" frames captured" translation_tag=" frames captured" style_text_color="#text_muted"/>
        </lv_obj>
        <!-- Render progress bar - hidden when idle -->
        <lv_obj name="render_progress_container" width="100%" height="content" scrollable="false"
                style_pad_left="#space_lg" style_pad_right="#space_lg" style_pad_bottom="#space_sm">
          <bind_flag_if_eq subject="timelapse_render_status" flag="hidden" ref_value="idle"/>
          <lv_bar name="render_progress_bar" width="100%" style_height="8"
                  bind_value="timelapse_render_progress" range_min="0" range_max="100"
                  style_bg_color="#overlay_bg" style_radius="4"/>
          <text_small name="render_status_text" bind_text="timelapse_render_status"
                      style_text_color="#text_muted" style_pad_top="#space_xs"/>
        </lv_obj>
        <!-- Render Now button -->
        <lv_obj width="100%" height="content" scrollable="false"
                style_pad_left="#space_lg" style_pad_right="#space_lg" style_pad_top="#space_xs">
          <lv_button name="btn_render_now" width="100%" style_bg_color="#primary"
                     style_radius="#border_radius" style_pad_all="#space_sm">
            <event_cb trigger="clicked" callback="on_timelapse_render_now"/>
            <text_body text="Render Now" translation_tag="Render Now"
                       style_text_color="#on_primary" style_text_align="center" width="100%"/>
          </lv_button>
        </lv_obj>
      </lv_obj>
      <!-- ================================================================== -->
      <!-- RECORDED VIDEOS -->
      <!-- ================================================================== -->
      <lv_obj name="video_list_section"
              width="100%" height="content" scrollable="false" flex_flow="column"
              style_pad_top="#space_md" style_pad_bottom="#space_sm">
        <lv_obj width="100%" height="content" scrollable="false"
                style_pad_left="#space_lg" style_pad_right="#space_lg" style_pad_bottom="#space_sm">
          <text_heading text="Recorded Videos" translation_tag="Recorded Videos"/>
        </lv_obj>
        <!-- Video list container - populated by C++ -->
        <lv_obj name="video_list_container"
                width="100%" height="content" scrollable="false" flex_flow="column"
                style_pad_left="#space_lg" style_pad_right="#space_lg" style_pad_gap="#space_xs"/>
        <!-- Empty state text -->
        <lv_obj name="video_list_empty"
                width="100%" height="content" scrollable="false"
                style_pad_left="#space_lg" style_pad_right="#space_lg" style_pad_top="#space_sm">
          <text_small text="No timelapse videos found" translation_tag="No timelapse videos found"
                      style_text_color="#text_muted" style_text_align="center" width="100%"/>
        </lv_obj>
      </lv_obj>
      <!-- ================================================================== -->
      <!-- INFO NOTE -->
      <!-- ================================================================== -->
      <lv_obj width="100%"
              height="content" scrollable="false" style_pad_left="#space_lg" style_pad_right="#space_lg"
              style_pad_top="#space_md" style_pad_bottom="#space_lg" flex_flow="row" style_flex_cross_place="center"
              style_flex_track_place="center" style_pad_gap="#space_sm">
        <icon src="info" size="xs" variant="secondary"/>
        <text_small text="Requires Moonraker-Timelapse plugin" translation_tag="Requires Moonraker-Timelapse plugin"/>
      </lv_obj>
    </lv_obj>
  </view>
</component>
