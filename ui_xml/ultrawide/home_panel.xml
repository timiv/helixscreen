<?xml version="1.0"?>
<!-- Copyright (C) 2025-2026 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<component>
  <consts>
    <px name="accent_bar_width" value="4"/>
    <px name="accent_bar_gap" value="14"/>
    <percentage name="printer_column_width" value="20%"/>
    <percentage name="print_column_width" value="35%"/>
  </consts>
  <styles>
    <style name="image_dimmed" image_opa="128"/>
    <style name="badge_info" bg_color="#info"/>
    <style name="badge_warning" bg_color="#warning"/>
    <style name="badge_error" bg_color="#danger"/>
  </styles>

  <!-- Root: horizontal 3-column layout -->
  <view extends="lv_obj"
        width="100%" height="100%" style_pad_all="0" style_pad_gap="0" style_border_width="0" flex_flow="row"
        style_bg_color="#screen_bg" scrollable="false">

    <!-- ================================================================ -->
    <!-- COLUMN 1: Printer Image + Info                                   -->
    <!-- ================================================================ -->
    <lv_obj width="#printer_column_width"
            height="100%" flex_flow="column" style_pad_all="#space_sm" style_pad_gap="0" scrollable="false">
      <!-- Printer image with connection overlays -->
      <lv_obj name="printer_container"
              width="100%" flex_grow="1" style_bg_color="#screen_bg" style_pad_all="0" scrollable="false" align="center"
              flex_flow="row">
        <lv_image name="printer_image" width="100%" height="100%" align="center" inner_align="contain">
          <bind_style name="image_dimmed" subject="printer_connection_state" ref_value="0"/>
          <bind_style name="image_dimmed" subject="printer_connection_state" ref_value="1"/>
          <bind_style name="image_dimmed" subject="klippy_state" ref_value="2"/>
          <bind_style name="image_dimmed" subject="klippy_state" ref_value="3"/>
        </lv_image>
        <icon name="disconnected_overlay" src="prohibited" size="xl" align="center" variant="danger">
          <bind_flag_if_eq subject="printer_connection_state" flag="hidden" ref_value="2"/>
        </icon>
        <icon name="shutdown_overlay" src="alert_octagon" size="xl" align="center" variant="warning" hidden="true">
          <bind_flag_if_not_eq subject="klippy_state" flag="hidden" ref_value="2"/>
        </icon>
      </lv_obj>

      <!-- Printer info bar -->
      <lv_obj name="printer_info_bar" width="100%" style_pad_all="0">
        <bind_flag_if_eq subject="printer_info_visible" flag="hidden" ref_value="0"/>
        <text_small width="100%"
                    height="content" bind_text="printer_type_text" style_text_color="#text" style_text_align="center"
                    stroke_width="1" stroke_color="#screen_bg" stroke_opa="180"/>
      </lv_obj>
    </lv_obj>

    <!-- ================================================================ -->
    <!-- COLUMN 2: Tip Area + Print Card                                  -->
    <!-- ================================================================ -->
    <lv_obj width="#print_column_width"
            height="100%" flex_flow="column" style_pad_all="#space_sm" style_pad_gap="#space_sm" scrollable="false">

      <!-- Tip area with accent bar -->
      <lv_obj width="100%"
              height="content" flex_flow="row" style_bg_opa="0%" style_radius="0" style_border_width="#accent_bar_width"
              style_border_side="left" style_border_color="#primary" style_pad_top="#space_xs"
              style_pad_bottom="#space_xs" style_pad_left="#accent_bar_gap" style_pad_right="0"
              style_pad_gap="#space_xs" style_flex_track_place="center" clickable="true">
        <event_cb trigger="clicked" callback="tip_text_clicked_cb"/>
        <text_body text="Tip:" translation_tag="Tip:"/>
        <text_body name="status_text_label" bind_text="status_text" flex_grow="1" long_mode="dot"/>
        <icon src="help_circle" size="md" variant="muted"/>
      </lv_obj>

      <!-- Print Card -->
      <ui_card name="print_card" width="100%" flex_grow="1">
        <bind_state_if_not_eq subject="printer_connection_state" state="disabled" ref_value="2"/>
        <event_cb trigger="clicked" callback="print_card_clicked_cb"/>

        <!-- IDLE STATE -->
        <lv_obj name="print_card_idle"
                width="100%" height="100%" style_pad_all="0" flex_flow="row" style_flex_main_place="center"
                style_flex_cross_place="center" style_pad_gap="#space_sm" clickable="false">
          <bind_flag_if_not_eq subject="print_active" flag="hidden" ref_value="0"/>
          <lv_image name="print_card_thumb"
                    width="40%" height="100%" src="A:assets/images/benchy_thumbnail_white.png" inner_align="contain"/>
          <text_body name="print_card_label" text="Print Files" translation_tag="Print Files"/>
        </lv_obj>

        <!-- PREPARING STATE -->
        <lv_obj name="print_card_preparing"
                width="100%" height="100%" style_pad_all="#space_sm" flex_flow="column" style_flex_main_place="center"
                style_flex_cross_place="center" style_pad_gap="#space_xs" hidden="true" clickable="false">
          <bind_flag_if_eq subject="print_start_phase" flag="hidden" ref_value="0"/>
          <text_body text="Preparing Print" translation_tag="Preparing Print"/>
          <lv_bar name="print_start_bar"
                  width="90%" height="8" bind_value="print_start_progress" min_value="0" max_value="100"
                  style_bg_color="#screen_bg" style_radius="4"/>
          <text_small bind_text="print_start_message"/>
          <text_small name="print_start_eta" bind_text="print_start_time_left" style_text_color="#text_muted"/>
        </lv_obj>

        <!-- PRINTING STATE -->
        <lv_obj name="print_card_printing"
                width="100%" height="100%" style_pad_all="#space_sm" flex_flow="row" style_flex_cross_place="center"
                style_pad_gap="#space_sm" scrollable="false" hidden="true" clickable="false">
          <bind_flag_if_eq subject="print_show_progress" flag="hidden" ref_value="0"/>
          <lv_obj width="35%" height="100%" style_pad_all="0" style_bg_opa="0%" scrollable="false" clickable="false">
            <lv_image name="print_card_active_thumb"
                      width="100%" height="100%" src="A:assets/images/benchy_thumbnail_white.png" inner_align="contain"/>
          </lv_obj>
          <lv_obj height="100%"
                  flex_grow="1" style_pad_all="0" flex_flow="column" style_flex_main_place="center"
                  style_flex_cross_place="center" style_pad_gap="#space_xs" scrollable="false" clickable="false">
            <ui_button name="estop_button_print"
                       width="#button_height_sm" height="#button_height_sm" variant="danger" style_radius="24"
                       focusable="false" hidden="true">
              <bind_flag_if_eq subject="estop_visible" flag="hidden" ref_value="0"/>
              <icon src="alert_octagon" size="sm" variant="text" align="center"/>
              <event_cb trigger="clicked" callback="emergency_stop_clicked"/>
            </ui_button>
            <text_body width="100%"
                       bind_text="print_display_filename" style_text_color="#text" long_mode="wrap"
                       style_text_align="center"/>
            <lv_bar name="print_progress_bar"
                    width="90%" height="8" bind_value="print_progress" min_value="0" max_value="100"
                    style_bg_color="#screen_bg" style_radius="4"/>
            <text_small bind_text="print_progress_text"/>
          </lv_obj>
        </lv_obj>
      </ui_card>
    </lv_obj>

    <!-- ================================================================ -->
    <!-- COLUMN 3: Status Indicators                                      -->
    <!-- ================================================================ -->
    <ui_card name="status_card"
             height="100%" flex_grow="1" flex_flow="column" style_pad_gap="#space_xs" style_margin_top="#space_sm"
             style_margin_bottom="#space_sm" style_margin_right="#space_sm">

      <!-- Top Row: Printer Status | Network | Notifications | Firmware Restart -->
      <lv_obj width="100%" flex_grow="1" style_pad_all="0" flex_flow="row" style_flex_cross_place="center">

        <!-- Printer Status -->
        <ui_button name="status_btn_printer"
                   height="100%" variant="ghost" flex_grow="1" flex_flow="column" style_flex_main_place="center"
                   style_flex_cross_place="center" style_flex_track_place="center" style_border_width="0"
                   focusable="false">
          <event_cb trigger="clicked" callback="printer_status_clicked_cb"/>
          <icon name="printer_icon_ready" src="printer_3d" size="#icon_size" variant="success" hidden="true">
            <bind_flag_if_not_eq subject="printer_icon_state" flag="hidden" ref_value="0"/>
          </icon>
          <icon name="printer_icon_warning" src="printer_3d" size="#icon_size" variant="warning" hidden="true">
            <bind_flag_if_not_eq subject="printer_icon_state" flag="hidden" ref_value="1"/>
          </icon>
          <icon name="printer_icon_error" src="printer_3d" size="#icon_size" variant="danger" hidden="true">
            <bind_flag_if_not_eq subject="printer_icon_state" flag="hidden" ref_value="2"/>
          </icon>
          <icon name="printer_icon_disconnected" src="printer_3d" size="#icon_size" variant="secondary">
            <bind_flag_if_not_eq subject="printer_icon_state" flag="hidden" ref_value="3"/>
          </icon>
        </ui_button>

        <divider_vertical name="status_divider" height="80%"/>

        <!-- Network -->
        <ui_button name="network_btn"
                   height="100%" variant="ghost" flex_grow="1" flex_flow="column" style_flex_main_place="center"
                   style_flex_cross_place="center" style_flex_track_place="center" style_border_width="0"
                   focusable="false">
          <event_cb trigger="clicked" callback="network_clicked_cb"/>
          <icon name="net_disconnected" src="wifi_off" size="#icon_size" variant="disabled">
            <bind_flag_if_not_eq subject="home_network_icon_state" flag="hidden" ref_value="0"/>
          </icon>
          <icon name="net_wifi_1" src="wifi_strength_1_alert" size="#icon_size" variant="warning">
            <bind_flag_if_not_eq subject="home_network_icon_state" flag="hidden" ref_value="1"/>
          </icon>
          <icon name="net_wifi_2" src="wifi_strength_2" size="#icon_size" variant="secondary">
            <bind_flag_if_not_eq subject="home_network_icon_state" flag="hidden" ref_value="2"/>
          </icon>
          <icon name="net_wifi_3" src="wifi_strength_3" size="#icon_size" variant="secondary">
            <bind_flag_if_not_eq subject="home_network_icon_state" flag="hidden" ref_value="3"/>
          </icon>
          <icon name="net_wifi_4" src="wifi_strength_4" size="#icon_size" variant="secondary">
            <bind_flag_if_not_eq subject="home_network_icon_state" flag="hidden" ref_value="4"/>
          </icon>
          <icon name="net_ethernet" src="ethernet" size="#icon_size" variant="success">
            <bind_flag_if_not_eq subject="home_network_icon_state" flag="hidden" ref_value="5"/>
          </icon>
        </ui_button>

        <divider_vertical name="divider1" height="80%"/>

        <!-- Notifications -->
        <lv_obj height="100%"
                flex_grow="1" style_pad_all="0" flex_flow="column" style_flex_main_place="center"
                style_flex_track_place="center">
          <lv_obj name="status_notification_container" style_pad_all="0">
            <icon name="status_notification_icon"
                  src="notifications" size="#icon_size" variant="secondary" align="center" clickable="true"
                  click_focusable="false">
              <event_cb trigger="clicked" callback="status_notification_history_clicked"/>
            </icon>
            <notification_badge name="notification_badge"
                                align="top_right" x="-#space_xxs" y="#space_xxs" hidden="true" clickable="true"
                                click_focusable="false" bind_text="notification_count_text">
              <bind_flag_if_eq subject="notification_count" flag="hidden" ref_value="0"/>
              <bind_style name="badge_info" subject="notification_severity" ref_value="0"/>
              <bind_style name="badge_warning" subject="notification_severity" ref_value="1"/>
              <bind_style name="badge_error" subject="notification_severity" ref_value="2"/>
              <event_cb trigger="clicked" callback="status_notification_history_clicked"/>
            </notification_badge>
          </lv_obj>
        </lv_obj>

        <!-- Firmware restart divider (only when klippy SHUTDOWN) -->
        <divider_vertical name="firmware_restart_divider" height="80%" hidden="true">
          <bind_flag_if_not_eq subject="klippy_state" flag="hidden" ref_value="2"/>
        </divider_vertical>

        <!-- Firmware restart button (only when klippy SHUTDOWN) -->
        <lv_obj height="100%"
                flex_grow="1" style_pad_all="0" flex_flow="column" style_flex_main_place="center"
                style_flex_track_place="center" hidden="true">
          <bind_flag_if_not_eq subject="klippy_state" flag="hidden" ref_value="2"/>
          <ui_button name="firmware_restart_button_home"
                     width="#button_height_sm" height="#button_height_sm" style_radius="24" style_border_width="0"
                     align="center" focusable="false">
            <icon src="refresh" size="sm" variant="text" align="center"/>
            <event_cb trigger="clicked" callback="firmware_restart_clicked"/>
          </ui_button>
        </lv_obj>
      </lv_obj>

      <!-- Bottom Row: Temp | Light | AMS | Humidity | Width | Probe | Filament -->
      <lv_obj width="100%" flex_grow="1" style_pad_all="0" flex_flow="row" style_flex_cross_place="center">

        <!-- Temperature -->
        <ui_button name="temp_btn"
                   height="100%" variant="ghost" flex_grow="1" flex_flow="column" style_flex_main_place="center"
                   style_flex_cross_place="center" style_flex_track_place="center" style_border_width="0"
                   focusable="false">
          <bind_state_if_not_eq subject="printer_connection_state" state="disabled" ref_value="2"/>
          <event_cb trigger="clicked" callback="temp_clicked_cb"/>
          <icon name="temp_icon" src="heater" size="#icon_size" variant="secondary"/>
          <temp_display name="temp_text_label"
                        width="100%" size="md" show_target="false" bind_current="extruder_temp"
                        bind_target="extruder_target" align="center"/>
        </ui_button>

        <divider_vertical name="divider2" height="80%">
          <bind_flag_if_eq subject="printer_has_led" flag="hidden" ref_value="0"/>
        </divider_vertical>

        <!-- Light -->
        <ui_button name="light_button"
                   height="100%" variant="ghost" flex_grow="1" style_border_width="0" focusable="false">
          <bind_flag_if_eq subject="printer_has_led" flag="hidden" ref_value="0"/>
          <bind_state_if_not_eq subject="printer_connection_state" state="disabled" ref_value="2"/>
          <icon name="light_icon" src="lightbulb_outline" size="#icon_size" align="center" variant="muted"/>
          <event_cb trigger="clicked" callback="light_toggle_cb"/>
        </ui_button>

        <!-- AMS divider + status -->
        <divider_vertical name="ams_divider" height="80%">
          <bind_flag_if_eq subject="ams_slot_count" flag="hidden" ref_value="0"/>
        </divider_vertical>
        <lv_obj height="100%" flex_grow="1" style_pad_all="0">
          <bind_flag_if_eq subject="ams_slot_count" flag="hidden" ref_value="0"/>
          <ams_mini_status/>
        </lv_obj>

        <!-- Humidity -->
        <divider_vertical name="divider_humidity" height="80%">
          <bind_flag_if_eq subject="humidity_sensor_count" flag="hidden" ref_value="0"/>
        </divider_vertical>
        <lv_obj name="humidity_status_container"
                height="100%" flex_grow="1" style_pad_all="0" flex_flow="column" style_flex_main_place="center"
                style_flex_cross_place="center" style_flex_track_place="center">
          <bind_flag_if_eq subject="humidity_sensor_count" flag="hidden" ref_value="0"/>
          <humidity_indicator/>
          <text_tiny text="Humidity" translation_tag="Humidity" style_text_align="center"/>
        </lv_obj>

        <!-- Width sensor -->
        <divider_vertical name="divider_width" height="80%">
          <bind_flag_if_eq subject="width_sensor_count" flag="hidden" ref_value="0"/>
        </divider_vertical>
        <lv_obj name="width_status_container"
                height="100%" flex_grow="1" style_pad_all="0" flex_flow="column" style_flex_main_place="center"
                style_flex_cross_place="center" style_flex_track_place="center">
          <bind_flag_if_eq subject="width_sensor_count" flag="hidden" ref_value="0"/>
          <width_indicator/>
          <text_tiny text="Width" translation_tag="Width" style_text_align="center"/>
        </lv_obj>

        <!-- Probe sensor -->
        <divider_vertical name="divider_probe" height="80%">
          <bind_flag_if_eq subject="probe_count" flag="hidden" ref_value="0"/>
        </divider_vertical>
        <lv_obj name="probe_status_container"
                height="100%" flex_grow="1" style_pad_all="0" flex_flow="column" style_flex_main_place="center"
                style_flex_cross_place="center" style_flex_track_place="center">
          <bind_flag_if_eq subject="probe_count" flag="hidden" ref_value="0"/>
          <probe_indicator/>
          <text_tiny text="Probe" translation_tag="Probe" style_text_align="center"/>
        </lv_obj>

        <!-- Filament sensor -->
        <divider_vertical name="divider_filament" height="80%">
          <bind_flag_if_eq subject="show_filament_status" flag="hidden" ref_value="0"/>
        </divider_vertical>
        <lv_obj name="filament_status_container"
                height="100%" flex_grow="1" style_pad_all="0" flex_flow="column" style_flex_main_place="center"
                style_flex_cross_place="center" style_flex_track_place="center">
          <bind_flag_if_eq subject="show_filament_status" flag="hidden" ref_value="0"/>
          <filament_sensor_indicator/>
          <text_tiny text="Loaded" translation_tag="Loaded" style_text_align="center">
            <bind_flag_if_not_eq subject="filament_runout_detected" flag="hidden" ref_value="1"/>
          </text_tiny>
          <text_tiny text="Empty" translation_tag="Empty" style_text_align="center">
            <bind_flag_if_not_eq subject="filament_runout_detected" flag="hidden" ref_value="0"/>
          </text_tiny>
        </lv_obj>
      </lv_obj>

      <!-- Plugin injection point -->
      <lv_obj name="home_widget_area"
              width="100%" height="content" style_pad_all="0" flex_flow="column" style_pad_gap="#space_sm"/>
    </ui_card>
  </view>
</component>
