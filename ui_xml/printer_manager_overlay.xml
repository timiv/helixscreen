<?xml version="1.0"?>
<!-- Copyright (C) 2025-2026 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<!-- Printer Manager Overlay - Shows printer identity, software versions, and hardware capabilities -->
<!-- Launched from home screen by tapping the printer image -->
<component>
  <consts>
    <!-- Printer image size: responsive to screen height breakpoints -->
    <!-- SMALL (â‰¤460px: 480x320, 1920x440), MEDIUM (461-700px: 800x480, 1024x600), LARGE (>700px: 1280x720+) -->
    <px name="pm_image_size_small" value="120"/>
    <px name="pm_image_size_medium" value="160"/>
    <px name="pm_image_size_large" value="200"/>
  </consts>
  <view name="printer_manager_overlay" extends="overlay_panel" title="Printer Manager">
    <!-- Scrollable content area -->
    <lv_obj name="overlay_content"
            width="100%" flex_grow="1" style_pad_all="0" style_pad_gap="0" flex_flow="column" scrollable="true"
            style_bg_color="#card_bg" style_bg_opa="255">

      <!-- ================================================================== -->
      <!-- SECTION 1: PRINTER IDENTITY -->
      <!-- ================================================================== -->
      <lv_obj width="100%"
              height="content" flex_flow="row" style_flex_main_place="center" style_flex_cross_place="center"
              style_flex_track_place="center" scrollable="false" style_bg_opa="0" style_border_width="0"
              style_pad_all="0">
        <lv_obj width="content"
                height="content" flex_flow="column" style_flex_cross_place="center" style_pad_top="#space_sm"
                style_pad_bottom="#space_sm" style_pad_left="#space_lg" style_pad_right="#space_lg"
                style_pad_gap="#space_xs" scrollable="false" style_bg_color="#elevated_bg" style_bg_opa="255"
                style_border_width="0" style_radius="#border_radius">
          <!-- Printer image (clickable to change) + pencil edit badge -->
          <lv_obj name="pm_image_container"
                  width="#pm_image_size" height="#pm_image_size" scrollable="false" clickable="true" style_bg_opa="0"
                  style_border_width="0" style_pad_all="0">
            <event_cb trigger="clicked" callback="on_change_printer_image_clicked"/>
            <lv_image name="pm_printer_image"
                      width="100%" height="100%" inner_align="contain" style_radius="#border_radius" clickable="false"
                      event_bubble="true"/>
            <!-- Pencil badge overlaid in lower-right corner of image -->
            <lv_obj width="#icon_button_size"
                    height="#icon_button_size" style_bg_color="#card_bg" style_bg_opa="#modal_backdrop_opacity"
                    style_radius="#border_radius" style_border_width="0" scrollable="false" align="bottom_right"
                    style_pad_all="0" style_translate_x="-8" style_translate_y="-8" clickable="false"
                    event_bubble="true">
              <icon src="pencil" size="xs" variant="tertiary" align="center" clickable="false" event_bubble="true"/>
            </lv_obj>
          </lv_obj>
          <!-- Printer name (click to edit) -->
          <lv_obj width="content"
                  height="content" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                  scrollable="false" style_bg_opa="0" style_border_width="0" style_pad_all="0" clickable="true">
            <event_cb trigger="clicked" callback="pm_printer_name_clicked"/>
            <text_heading name="pm_printer_name"
                          width="content" bind_text="printer_manager_name" style_text_align="center" clickable="false"
                          event_bubble="true"/>
            <icon src="pencil" size="xs" variant="tertiary" clickable="false" event_bubble="true"/>
          </lv_obj>
          <!-- Hidden text input for name editing (shown when heading is clicked) -->
          <text_input name="pm_printer_name_input"
                      width="content" height="#input_height" placeholder_text="Printer name" style_text_align="center"
                      hidden="true" one_line="true" scrollbar_mode="off"/>
          <!-- Printer model -->
          <text_muted name="pm_printer_model"
                      width="content" bind_text="printer_manager_model" style_text_align="center"/>
        </lv_obj>
      </lv_obj>

      <!-- ================================================================== -->
      <!-- SECTION 2: SOFTWARE VERSIONS -->
      <!-- ================================================================== -->
      <setting_section_header title="SOFTWARE" title_tag="SOFTWARE" icon="info"/>
      <setting_info_row name="pm_row_klipper" label="Klipper" label_tag="Klipper" icon="toy_brick_outline">
        <text_muted name="value" bind_text="klipper_version"/>
      </setting_info_row>
      <setting_info_row name="pm_row_moonraker" label="Moonraker" label_tag="Moonraker" icon="toy_brick_outline">
        <text_muted name="value" bind_text="moonraker_version"/>
      </setting_info_row>
      <setting_info_row name="pm_row_helix" label="HelixScreen" label_tag="HelixScreen" icon="info">
        <text_muted name="value" bind_text="helix_version"/>
      </setting_info_row>

      <!-- ================================================================== -->
      <!-- SECTION 3: HARDWARE CAPABILITIES -->
      <!-- ================================================================== -->
      <setting_section_header title="CAPABILITIES" title_tag="CAPABILITIES" icon="wrench"/>
      <lv_obj width="100%"
              height="content" flex_flow="row_wrap" style_pad_left="#space_lg" style_pad_right="#space_lg"
              style_pad_gap="#space_sm" style_pad_top="#space_sm" style_pad_bottom="#space_lg" scrollable="false"
              style_bg_opa="0" style_border_width="0">

        <!-- Probe -->
        <lv_obj width="content"
                height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0">
          <bind_flag_if_eq subject="printer_has_probe" flag="hidden" ref_value="0"/>
          <icon src="target" size="xs" variant="success"/>
          <text_small text="Probe"/>
        </lv_obj>

        <!-- Bed Mesh -->
        <lv_obj name="pm_chip_bed_mesh"
                width="content" height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0" clickable="true">
          <bind_flag_if_eq subject="printer_has_bed_mesh" flag="hidden" ref_value="0"/>
          <event_cb trigger="clicked" callback="pm_chip_bed_mesh_clicked"/>
          <icon src="grid_large" size="xs" variant="success"/>
          <text_small text="Bed Mesh"/>
        </lv_obj>

        <!-- Heated Bed -->
        <lv_obj width="content"
                height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0">
          <bind_flag_if_eq subject="printer_has_heater_bed" flag="hidden" ref_value="0"/>
          <icon src="radiator" size="xs" variant="success"/>
          <text_small text="Heated Bed"/>
        </lv_obj>

        <!-- LEDs -->
        <lv_obj name="pm_chip_leds"
                width="content" height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0" clickable="true">
          <bind_flag_if_eq subject="printer_has_led" flag="hidden" ref_value="0"/>
          <event_cb trigger="clicked" callback="pm_chip_leds_clicked"/>
          <icon src="lightbulb_on" size="xs" variant="success"/>
          <text_small text="LEDs"/>
        </lv_obj>

        <!-- ADXL -->
        <lv_obj name="pm_chip_adxl"
                width="content" height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0" clickable="true">
          <bind_flag_if_eq subject="printer_has_accelerometer" flag="hidden" ref_value="0"/>
          <event_cb trigger="clicked" callback="pm_chip_adxl_clicked"/>
          <icon src="vibrate" size="xs" variant="success"/>
          <text_small text="ADXL"/>
        </lv_obj>

        <!-- QGL -->
        <lv_obj width="content"
                height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0">
          <bind_flag_if_eq subject="printer_has_qgl" flag="hidden" ref_value="0"/>
          <icon src="tune_vertical_variant" size="xs" variant="success"/>
          <text_small text="QGL"/>
        </lv_obj>

        <!-- Z-Tilt -->
        <lv_obj width="content"
                height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0">
          <bind_flag_if_eq subject="printer_has_z_tilt" flag="hidden" ref_value="0"/>
          <icon src="swap_vertical" size="xs" variant="success"/>
          <text_small text="Z-Tilt"/>
        </lv_obj>

        <!-- Firmware Retraction -->
        <lv_obj name="pm_chip_retraction"
                width="content" height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0" clickable="true">
          <bind_flag_if_eq subject="printer_has_firmware_retraction" flag="hidden" ref_value="0"/>
          <event_cb trigger="clicked" callback="pm_chip_retraction_clicked"/>
          <icon src="arrow_up_right" size="xs" variant="success"/>
          <text_small text="Retraction"/>
        </lv_obj>

        <!-- Spoolman -->
        <lv_obj name="pm_chip_spoolman"
                width="content" height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0" clickable="true">
          <bind_flag_if_eq subject="printer_has_spoolman" flag="hidden" ref_value="0"/>
          <event_cb trigger="clicked" callback="pm_chip_spoolman_clicked"/>
          <icon src="database" size="xs" variant="success"/>
          <text_small text="Spoolman"/>
        </lv_obj>

        <!-- Timelapse -->
        <lv_obj name="pm_chip_timelapse"
                width="content" height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0" clickable="true">
          <bind_flag_if_eq subject="printer_has_timelapse" flag="hidden" ref_value="0"/>
          <event_cb trigger="clicked" callback="pm_chip_timelapse_clicked"/>
          <icon src="camera_timer" size="xs" variant="success"/>
          <text_small text="Timelapse"/>
        </lv_obj>

        <!-- Screws Tilt -->
        <lv_obj name="pm_chip_screws_tilt"
                width="content" height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0" clickable="true">
          <bind_flag_if_eq subject="printer_has_screws_tilt" flag="hidden" ref_value="0"/>
          <event_cb trigger="clicked" callback="pm_chip_screws_tilt_clicked"/>
          <icon src="rotate_left" size="xs" variant="success"/>
          <text_small text="Screws Tilt"/>
        </lv_obj>

        <!-- Webcam -->
        <lv_obj width="content"
                height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0">
          <bind_flag_if_eq subject="printer_has_webcam" flag="hidden" ref_value="0"/>
          <icon src="video" size="xs" variant="success"/>
          <text_small text="Webcam"/>
        </lv_obj>

        <!-- AMS / Multi-Material -->
        <lv_obj name="pm_chip_ams"
                width="content" height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0" clickable="true">
          <bind_flag_if_eq subject="ams_type" flag="hidden" ref_value="0"/>
          <event_cb trigger="clicked" callback="pm_chip_ams_clicked"/>
          <icon src="source_branch" size="xs" variant="success"/>
          <text_small text="AMS"/>
        </lv_obj>

        <!-- Extra Fans -->
        <lv_obj name="pm_chip_fans"
                width="content" height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0" clickable="true">
          <bind_flag_if_eq subject="printer_has_extra_fans" flag="hidden" ref_value="0"/>
          <event_cb trigger="clicked" callback="pm_chip_fans_clicked"/>
          <icon src="fan" size="xs" variant="success"/>
          <text_small text="Fans"/>
        </lv_obj>

        <!-- Chamber Sensor -->
        <lv_obj width="content"
                height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0">
          <bind_flag_if_eq subject="printer_has_chamber_sensor" flag="hidden" ref_value="0"/>
          <icon src="thermometer" size="xs" variant="success"/>
          <text_small text="Chamber"/>
        </lv_obj>

        <!-- Speaker -->
        <lv_obj name="pm_chip_speaker"
                width="content" height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0" clickable="true">
          <bind_flag_if_eq subject="printer_has_speaker" flag="hidden" ref_value="0"/>
          <event_cb trigger="clicked" callback="pm_chip_speaker_clicked"/>
          <icon src="volume_high" size="xs" variant="success"/>
          <text_small text="Speaker"/>
        </lv_obj>

        <!-- Nozzle Clean -->
        <lv_obj width="content"
                height="content" style_bg_color="#card_bg" style_bg_opa="255" style_radius="16"
                style_pad_top="#space_xs" style_pad_bottom="#space_xs" style_pad_left="#space_sm"
                style_pad_right="#space_sm" flex_flow="row" style_pad_gap="#space_xs" style_flex_cross_place="center"
                scrollable="false" style_border_width="0">
          <bind_flag_if_eq subject="printer_has_nozzle_clean" flag="hidden" ref_value="0"/>
          <icon src="filament" size="xs" variant="success"/>
          <text_small text="Nozzle Clean"/>
        </lv_obj>

      </lv_obj>

      <!-- Bottom padding for scroll -->
      <lv_obj width="100%" height="#space_lg" scrollable="false"/>
    </lv_obj>
  </view>
</component>
