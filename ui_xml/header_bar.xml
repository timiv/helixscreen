<?xml version="1.0"?>
<!-- Copyright 2025 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<component>
  <!-- Reusable Header Bar Component - Improved Design v2 -->
  <!-- Used in modal overlays, sub-screens, and detail views -->
  <!-- Provides consistent back button + centered title + optional action button -->
  <!-- Key improvements over v1:
       - Flat 3-element layout (no nested containers) for true centering
       - Symmetric padding (left + right) for visual balance
       - Title uses flex_grow + text_align for perfect centering
       - Uses text_heading/text_body components for theme consistency
       - XML-controlled action button visibility via hide_action_button prop
  -->
  <!-- API Properties -->
  <api>
    <prop name="title" type="string"/>
    <!-- Back button callback - defaults to standard navigation go_back -->
    <prop name="back_button_callback" type="string" default="on_header_back_clicked"/>
    <!-- Text-based action button (use action_button_text) -->
    <prop name="action_button_text" type="string" default=""/>
    <!-- Icon-based action button (use action_button_icon instead of text) -->
    <prop name="action_button_icon" type="string" default=""/>
    <!-- Hide the icon in action button (for text-only buttons) -->
    <prop name="hide_action_button_icon" type="string" default="false"/>
    <prop name="action_button_icon_color" type="string" default="#text_primary"/>
    <!-- Styling props for custom action buttons (e.g., E-stop) -->
    <prop name="action_button_bg_color" type="string" default="#primary_color"/>
    <prop name="action_button_radius" type="string" default="#border_radius"/>
    <!-- Use hide_action_button="false" to show the action button -->
    <prop name="hide_action_button" type="string" default="true"/>
    <prop name="action_button_callback" type="string" default=""/>
  </api>
  <view extends="lv_obj"
        width="100%" height="#header_height" style_bg_opa="0" style_border_width="0" style_pad_left="#space_md"
        style_pad_right="#space_lg" style_pad_top="#space_xs" style_pad_bottom="#space_xs" flex_flow="row"
        style_flex_main_place="space_between" style_flex_track_place="center" style_flex_cross_place="center"
        scrollable="false">
    <!-- Back button (fixed width, left-aligned) -->
    <icon name="back_button" src="back" size="lg" color="#text_primary" align="center" clickable="true">
      <event_cb trigger="clicked" callback="$back_button_callback"/>
    </icon>
    <!-- Title (flexible width, centered) -->
    <text_heading name="header_title"
                  text="$title" flex_grow="1" align="center" style_text_align="left" style_pad_left="#space_lg"
                  scrollable="false"/>
    <!-- Action button (hidden by default, pass hide_action_button="false" to show) -->
    <!-- Supports both text (action_button_text) and icon (action_button_icon) modes -->
    <!-- For icon-only buttons like E-stop, use circular radius and custom bg_color -->
    <lv_button name="action_button"
               width="content" height="#header_action_button_height" style_min_width="#header_action_button_height"
               style_radius="$action_button_radius" style_bg_color="$action_button_bg_color" style_border_width="0"
               style_shadow_width="0" style_pad_left="#space_md" style_pad_right="#space_md" flex_flow="row"
               style_flex_cross_place="center" style_pad_gap="#space_xs" scrollable="false" hidden="$hide_action_button">
      <icon name="action_button_icon_widget"
            src="$action_button_icon" size="sm" color="$action_button_icon_color" hidden="$hide_action_button_icon"/>
      <text_body name="action_button_label" text="$action_button_text"/>
      <event_cb trigger="clicked" callback="$action_button_callback"/>
    </lv_button>
  </view>
</component>
