<?xml version="1.0"?>
<!-- Copyright 2025 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->

<component>
  <!-- First-Run Wizard: WiFi Setup Screen -->
  <!-- Configure WiFi connection (optional, can skip) -->
  <consts>
    <!-- WiFi status text constants -->
    <str name="wifi_status.disabled" value="WiFi Disabled"/>
    <str name="wifi_status.enabled" value="WiFi Enabled"/>
    <str name="wifi_status.scanning" value="Scanning..."/>
    <str name="wifi_status.connecting" value="Connecting to "/>
    <str name="wifi_status.connected" value="Connected to "/>
    <str name="wifi_status.auth_failed" value="Authentication failed"/>
    <str name="wifi_status.timeout" value="Connection timeout"/>
  </consts>
  <view extends="lv_obj" width="100%" height="100%" scrollable="false" style_bg_opa="0" style_border_width="0" style_pad_all="0" flex_flow="column" style_flex_main_place="start" style_flex_cross_place="start" name="wizard_wifi_setup_root">
    <!-- Top Section: Instructions and Two-Column Layout -->
    <lv_obj width="100%" flex_grow="1" scrollable="false" style_bg_opa="0" style_radius="0" style_border_width="0" style_pad_all="0" style_pad_gap="#gap_normal" flex_flow="column" style_flex_main_place="start" style_flex_cross_place="start">
      <!-- Help text -->
      <text_body text="Connect to WiFi network (optional)" width="100%"/>
      <text_small text="Configure WiFi now or skip to use Ethernet/localhost" width="100%"/>
      <!-- Two-column row: WiFi/Ethernet (left) and Network List (right) -->
      <lv_obj width="100%" flex_grow="1" style_bg_opa="0" style_border_width="0" style_pad_all="0" style_pad_gap="#gap_normal" flex_flow="row" style_flex_main_place="start" style_flex_cross_place="start">
        <!-- LEFT COLUMN: WiFi and Ethernet Cards (40%) -->
        <lv_obj flex_grow="4" height="100%" scrollable="true" scroll_dir="VER" style_bg_opa="0" style_border_width="0" style_pad_all="0" style_pad_gap="#gap_normal" flex_flow="column" style_flex_main_place="start" style_flex_cross_place="start">
          <!-- WiFi Card -->
          <ui_card width="100%" flex_grow="6" scrollable="false" flex_flow="column" style_flex_main_place="start" style_flex_cross_place="center">
            <!-- Label + Switch horizontal container -->
            <lv_obj width="100%" height="#wifi_toggle_height" scrollable="false" style_bg_opa="0" style_pad_all="0" style_pad_top="6" style_border_width="0" style_pad_right="#padding_tiny" flex_flow="row" style_flex_main_place="space_between" style_flex_cross_place="center">
              <lv_label text="WiFi"/>
              <!-- WiFi toggle: wired to wifi_enabled subject via C++ event handler -->
              <ui_switch name="wifi_toggle" size="small">
                <!-- Bind checked state to wifi_enabled subject (bidirectional) -->
                <event_cb trigger="value_changed" callback="on_wifi_toggle_changed"/>
              </ui_switch>
            </lv_obj>
            <!-- WiFi Status label -->
            <text_small name="wifi_status" bind_text="wifi_status" width="100%" style_text_align="center" style_pad_top="#gap_small"/>
          </ui_card>
          <!-- Ethernet Status Card -->
          <ui_card width="100%" flex_grow="4" style_pad_all="#padding_normal" flex_flow="column" style_flex_main_place="start" style_flex_cross_place="start">
            <lv_label text="Ethernet" style_pad_bottom="#gap_small"/>
            <!-- Ethernet Status label -->
            <text_small name="ethernet_status" bind_text="ethernet_status" width="100%" style_text_align="left"/>
          </ui_card>
        </lv_obj>
        <!-- RIGHT COLUMN: Network List (60%) -->
        <!-- State-driven styling: automatically dims to 50% opacity when disabled -->
        <ui_card flex_grow="6" height="100%" name="network_list_container" flex_flow="column" scrollable="true" scroll_dir="VER" scroll_elastic="false" style_clip_corner="true" style_flex_main_place="start" style_flex_cross_place="start">
          <!-- Reactive state binding: set disabled state when wifi_enabled == 0 -->
          <lv_obj-bind_state_if_eq subject="wifi_enabled" state="disabled" ref_value="0"/>
          <!-- Title -->
          <lv_label text="Available Networks" width="100%" style_text_font="#font_heading" style_pad_bottom="#gap_small"/>
          <!-- Scanning indicator (shown when wifi_scanning == 1) -->
          <lv_label name="network_list_scanning" text="Scanning for networks..." width="100%" style_text_align="center">
            <!-- Show only when scanning (hide when wifi_scanning == 0) -->
            <lv_obj-bind_flag_if_eq subject="wifi_scanning" flag="hidden" ref_value="0"/>
          </lv_label>
          <!-- Placeholder shown when WiFi is disabled (wifi_enabled == 0) -->
          <text_body name="network_list_placeholder" text="Enable WiFi to scan for networks" width="100%" style_text_align="center">
            <!-- Show placeholder only when WiFi is disabled (hidden when enabled) -->
            <lv_obj-bind_flag_if_eq subject="wifi_enabled" flag="hidden" ref_value="1"/>
          </text_body>
          <!-- Network list populated dynamically from C++ -->
        </ui_card>
      </lv_obj>
    </lv_obj>
    <!-- Password modal now created on-demand via modal system -->
  </view>
</component>
