<?xml version="1.0"?>
<!-- Copyright (C) 2025-2026 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<component>
  <!-- First-Run Wizard: WiFi Setup Screen -->
  <!-- Configure WiFi connection (optional, can skip) -->
  <consts>
    <!-- Step metadata (read by wizard orchestrator) -->
    <str name="step_title" value="Printer Setup: Network"/>
    <str name="step_subtitle" value="Configure WiFi for this device, or skip if you're using Ethernet"/>
    <int name="step_order" value="1"/>
    <!-- WiFi status text constants -->
    <str name="wifi_status.disabled" value="WiFi Disabled"/>
    <str name="wifi_status.enabled" value="WiFi Enabled"/>
    <str name="wifi_status.scanning" value="Scanning..."/>
    <str name="wifi_status.connecting" value="Connecting to "/>
    <str name="wifi_status.connected" value="Connected to "/>
    <str name="wifi_status.auth_failed" value="Authentication failed"/>
    <str name="wifi_status.timeout" value="Connection timeout"/>
  </consts>
  <view name="wizard_wifi_setup_root"
        extends="lv_obj" width="100%" height="100%" scrollable="false" style_bg_opa="0" style_border_width="0"
        style_pad_all="0" flex_flow="column" style_flex_main_place="start" style_flex_cross_place="start">
    <!-- Two-column layout: WiFi/Ethernet (left) and Network List (right) -->
    <lv_obj width="100%"
            flex_grow="1" style_bg_opa="0" style_border_width="0" style_pad_all="0" style_pad_gap="#space_md"
            flex_flow="row" style_flex_main_place="start" style_flex_cross_place="start">
      <!-- LEFT COLUMN: WiFi and Ethernet Cards (40%) -->
      <lv_obj height="100%"
              flex_grow="4" scrollable="true" scroll_dir="VER" style_bg_opa="0" style_border_width="0" style_pad_all="0"
              style_pad_gap="#space_md" flex_flow="column" style_flex_main_place="start" style_flex_cross_place="start">
        <!-- WiFi Card -->
        <ui_card width="100%"
                 flex_grow="6" flex_flow="column" style_flex_main_place="start" style_flex_cross_place="center">
          <!-- Disable card when WiFi hardware unavailable -->
          <bind_state_if_eq subject="wifi_hardware_available" state="disabled" ref_value="0"/>
          <!-- Label + Switch horizontal container -->
          <lv_obj width="100%"
                  height="content" scrollable="false" style_bg_opa="0" style_pad_all="0" style_pad_top="#space_sm"
                  style_border_width="0" style_pad_right="#space_xs" flex_flow="row"
                  style_flex_main_place="space_between" style_flex_cross_place="center">
            <text_heading text="WiFi"/>
            <!-- WiFi toggle: wired to wifi_enabled subject via C++ event handler -->
            <ui_switch name="wifi_toggle" size="small">
              <bind_state_if_eq subject="wifi_hardware_available" state="disabled" ref_value="0"/>
              <event_cb trigger="value_changed" callback="on_wifi_toggle_changed"/>
            </ui_switch>
          </lv_obj>
          <!-- WiFi Status label (shows connected SSID or status) -->
          <text_small name="wifi_status"
                      width="100%" bind_text="wifi_status" style_text_align="center" style_pad_top="#space_sm"/>
          <!-- WiFi IP address (shown when connected) -->
          <text_small name="wifi_ip"
                      width="100%" bind_text="wifi_ip" style_text_align="center" style_pad_top="#space_xs"/>
        </ui_card>
        <!-- Ethernet Status Card -->
        <ui_card width="100%"
                 flex_grow="4" style_pad_all="#space_lg" flex_flow="column" style_flex_main_place="start"
                 style_flex_cross_place="start">
          <text_heading text="Ethernet" style_pad_bottom="#space_sm"/>
          <!-- Ethernet Status label -->
          <text_small name="ethernet_status" width="100%" bind_text="ethernet_status" style_text_align="left"/>
        </ui_card>
      </lv_obj>
      <!-- RIGHT COLUMN: Network List (60%) -->
      <!-- State-driven styling: automatically dims to 50% opacity when disabled -->
      <ui_card name="network_list_container"
               height="100%" flex_grow="6" flex_flow="column" scrollable="true" scroll_dir="VER" scroll_elastic="false"
               style_clip_corner="true" style_flex_main_place="start" style_flex_cross_place="start">
        <!-- Reactive state binding: set disabled state when wifi_enabled == 0 -->
        <bind_state_if_eq subject="wifi_enabled" state="disabled" ref_value="0"/>
        <!-- Also disable when hardware unavailable -->
        <bind_state_if_eq subject="wifi_hardware_available" state="disabled" ref_value="0"/>
        <!-- Title -->
        <text_heading width="100%" text="Available Networks" style_pad_bottom="#space_sm"/>
        <!-- Scanning indicator (shown when wifi_scanning == 1) -->
        <text_body name="network_list_scanning" width="100%" text="Scanning for networks..." style_text_align="center">
          <!-- Show only when scanning (hide when wifi_scanning == 0) -->
          <bind_flag_if_eq subject="wifi_scanning" flag="hidden" ref_value="0"/>
        </text_body>
        <!-- Placeholder shown when WiFi is disabled (wifi_enabled == 0) -->
        <text_body name="network_list_placeholder"
                   width="100%" text="Enable WiFi to scan for networks" style_text_align="center">
          <!-- Show placeholder only when WiFi is disabled (hidden when enabled) -->
          <bind_flag_if_eq subject="wifi_enabled" flag="hidden" ref_value="1"/>
        </text_body>
        <!-- Network list populated dynamically from C++ -->
      </ui_card>
    </lv_obj>
    <!-- Password modal now created on-demand via modal system -->
  </view>
</component>
