<?xml version="1.0"?>
<!-- Copyright (C) 2025-2026 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<!-- Modal for editing Spoolman spool properties -->
<!-- NOTE: Backdrop created programmatically by Modal system -->
<!-- Layout: Spool preview left, 2-column form grid right, notes full-width below -->
<component>
  <consts>
    <!-- Left column sized to fit spool preview + labels -->
    <px name="left_column_width" value="120"/>
    <!-- Notes textarea height: 2 visible lines + padding (tighter on small screens) -->
    <px name="notes_height_small" value="44"/>
    <px name="notes_height_medium" value="72"/>
    <px name="notes_height_large" value="88"/>
  </consts>
  <!-- Dialog card -->
  <view name="spoolman_edit_modal"
        extends="ui_dialog" width="70%" style_min_width="380" style_max_width="520"
        height="content" align="center" flex_flow="column" style_flex_main_place="start"
        style_pad_gap="0">
    <!-- Header with title and close button -->
    <lv_obj width="100%"
            height="content" style_pad_left="#space_lg" style_pad_right="#space_md" style_pad_top="#space_lg"
            style_pad_bottom="#space_sm" flex_flow="row" style_flex_main_place="space_between"
            style_flex_cross_place="center" scrollable="false">
      <text_heading name="spool_title" text="Edit Spool"/>
      <ui_button name="btn_close" width="#button_height_sm" height="#button_height_sm" icon="close" variant="ghost" focusable="false">
        <event_cb trigger="clicked" callback="spoolman_edit_close_cb"/>
      </ui_button>
    </lv_obj>
    <!-- Horizontal divider -->
    <divider_horizontal/>
    <!-- Content area: spool preview left, form right -->
    <lv_obj width="100%"
            height="content" style_pad_left="#space_md" style_pad_right="#space_md"
            style_pad_top="#space_md" style_pad_bottom="#space_sm"
            flex_flow="row" style_flex_cross_place="center" style_pad_gap="#space_lg" scrollable="false">
      <!-- LEFT: Spool canvas preview (centered) + read-only info (left-aligned) -->
      <lv_obj width="#left_column_width"
              height="content" style_pad_all="0" flex_flow="column" style_flex_main_place="start"
              style_flex_cross_place="center" style_pad_gap="#space_sm" scrollable="false">
        <spool_canvas name="spool_preview" size="#button_height_lg" color="#text_muted" fill_level="0.5"/>
        <lv_obj width="content" height="content" style_pad_all="0" flex_flow="column"
                style_pad_gap="#space_xxs" scrollable="false">
          <text_small name="material_label" text="PLA" style_text_color="#text"/>
          <text_small name="color_label" text="Black" style_text_color="#text_muted"/>
          <text_small name="vendor_label" text="Polymaker" style_text_color="#text_muted"/>
        </lv_obj>
      </lv_obj>
      <!-- RIGHT: Form fields in 2-column grid -->
      <lv_obj height="content"
              flex_grow="1" style_pad_all="0" flex_flow="column" style_flex_main_place="start"
              style_flex_cross_place="start" style_pad_gap="#space_sm" scrollable="false">
        <!-- Row 1: Remaining (g) | Spool wt (g) -->
        <lv_obj width="100%"
                height="content" style_pad_all="0" flex_flow="row" style_pad_gap="#space_md" scrollable="false">
          <lv_obj flex_grow="1"
                  height="content" style_pad_all="0" flex_flow="column" style_pad_gap="#space_xxs" scrollable="false">
            <text_small text="Remaining (g)" translation_tag="Remaining (g)"/>
            <text_input name="field_remaining" width="100%" input_mode="number" keyboard_hint="numeric" placeholder="1000" max_length="8">
              <event_cb trigger="value_changed" callback="spoolman_edit_field_changed_cb"/>
            </text_input>
          </lv_obj>
          <lv_obj flex_grow="1"
                  height="content" style_pad_all="0" flex_flow="column" style_pad_gap="#space_xxs" scrollable="false">
            <text_small text="Spool wt (g)" translation_tag="Spool wt (g)"/>
            <text_input name="field_spool_weight" width="100%" input_mode="number" keyboard_hint="numeric" placeholder="0" max_length="8">
              <event_cb trigger="value_changed" callback="spoolman_edit_field_changed_cb"/>
            </text_input>
          </lv_obj>
        </lv_obj>
        <!-- Row 2: Price | Lot Nr -->
        <lv_obj width="100%"
                height="content" style_pad_all="0" flex_flow="row" style_pad_gap="#space_md" scrollable="false">
          <lv_obj flex_grow="1"
                  height="content" style_pad_all="0" flex_flow="column" style_pad_gap="#space_xxs" scrollable="false">
            <text_small text="Price" translation_tag="Price"/>
            <text_input name="field_price" width="100%" input_mode="number" keyboard_hint="numeric" placeholder="0.00" max_length="10">
              <event_cb trigger="value_changed" callback="spoolman_edit_field_changed_cb"/>
            </text_input>
          </lv_obj>
          <lv_obj flex_grow="1"
                  height="content" style_pad_all="0" flex_flow="column" style_pad_gap="#space_xxs" scrollable="false">
            <text_small text="Lot/Batch Nr" translation_tag="Lot/Batch Nr"/>
            <text_input name="field_lot_nr" width="100%" placeholder="" max_length="32">
              <event_cb trigger="value_changed" callback="spoolman_edit_field_changed_cb"/>
            </text_input>
          </lv_obj>
        </lv_obj>
        <!-- Row 3: Notes (full width) -->
        <lv_obj width="100%"
                height="content" style_pad_all="0" flex_flow="column" style_pad_gap="#space_xxs" scrollable="false">
          <text_small text="Notes" translation_tag="Notes"/>
          <text_input name="field_comment" width="100%" height="#notes_height" placeholder="" max_length="256" multiline="true">
            <event_cb trigger="value_changed" callback="spoolman_edit_field_changed_cb"/>
          </text_input>
        </lv_obj>
      </lv_obj>
    </lv_obj>
    <!-- Action buttons -->
    <modal_button_row secondary_text="Reset"
                      secondary_callback="spoolman_edit_reset_cb"
                      primary_text="@spoolman_edit_save_text"
                      primary_callback="spoolman_edit_save_cb"/>
  </view>
</component>
