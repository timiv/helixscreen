<?xml version="1.0"?>
<!-- Copyright 2025 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<!-- Bed Mesh Panel - Mainsail-inspired two-card layout -->
<!-- Left: 3D mesh visualization with touch drag rotation -->
<!-- Right: "Current Mesh" stats card + "Profiles" list card -->
<component>
  <view name="bed_mesh_panel"
        extends="lv_obj" width="#overlay_panel_width_large" height="100%" align="right_mid" style_bg_opa="255"
        style_bg_color="#card_bg" style_pad_all="0" style_border_width="0" scrollable="false" flex_flow="column">
    <!-- Header Bar with CALIBRATE action button -->
    <header_bar name="overlay_header" title="Bed Mesh" action_button_text="CALIBRATE" hide_action_button="false">
      <event_cb trigger="clicked" callback="on_bed_mesh_calibrate_clicked"/>
    </header_bar>
    <!-- Content Area: Horizontal split (Left=Canvas, Right=Cards) -->
    <lv_obj name="overlay_content"
            width="100%" flex_grow="1" style_bg_opa="0" style_pad_all="#space_md" scrollable="false"
            style_border_width="0" flex_flow="row" style_pad_gap="#space_md">
      <!-- Left: 3D Mesh Canvas (fills remaining space) -->
      <bed_mesh name="bed_mesh_canvas" height="100%" flex_grow="1" clickable="true" style_border_width="0"/>
      <!-- Right: Info column with two cards -->
      <lv_obj name="info_column"
              width="220" height="100%" flex_flow="column" style_bg_opa="0" style_border_width="0" style_pad_all="0"
              style_pad_gap="#space_md" scrollable="false">
        <!-- ============================================================ -->
        <!-- CURRENT MESH CARD -->
        <!-- ============================================================ -->
        <lv_obj name="current_mesh_card"
                width="100%" height="content" style_bg_color="#card_surface" style_bg_opa="255" style_border_width="1"
                style_border_color="#card_border" style_radius="#card_radius" style_pad_all="0" flex_flow="column"
                scrollable="false">
          <!-- Card Header -->
          <lv_obj width="100%"
                  height="content" flex_flow="row" style_flex_cross_place="center" style_bg_opa="0"
                  style_border_width="0" style_pad_left="#space_md" style_pad_right="#space_md"
                  style_pad_top="#space_sm" style_pad_bottom="#space_sm" style_pad_gap="#space_sm" scrollable="false">
            <icon src="info" size="sm" color="#accent_color"/>
            <text_body text="Current Mesh" style_text_color="#text_primary" flex_grow="1"/>
          </lv_obj>
          <!-- Divider -->
          <lv_obj width="100%"
                  height="1" style_bg_color="#card_border" style_bg_opa="255" style_border_width="0" scrollable="false"/>
          <!-- Card Content -->
          <lv_obj width="100%"
                  height="content" flex_flow="column" style_bg_opa="0" style_border_width="0" style_pad_all="#space_md"
                  style_pad_gap="#space_xs" scrollable="false">
            <!-- Name row -->
            <lv_obj width="100%"
                    height="content" flex_flow="row" style_flex_main_place="space_between" style_bg_opa="0"
                    style_border_width="0" style_pad_all="0" scrollable="false">
              <text_small text="Name" style_text_color="#text_secondary"/>
              <text_small name="mesh_name_value" bind_text="bed_mesh_profile_name" style_text_color="#accent_color"/>
            </lv_obj>
            <!-- Size row -->
            <lv_obj width="100%"
                    height="content" flex_flow="row" style_flex_main_place="space_between" style_bg_opa="0"
                    style_border_width="0" style_pad_all="0" scrollable="false">
              <text_small text="Size" style_text_color="#text_secondary"/>
              <text_small name="mesh_size_value" bind_text="bed_mesh_dimensions" style_text_color="#text_primary"/>
            </lv_obj>
            <!-- Max row -->
            <lv_obj width="100%"
                    height="content" flex_flow="row" style_flex_main_place="space_between" style_bg_opa="0"
                    style_border_width="0" style_pad_all="0" scrollable="false">
              <text_small name="mesh_max_label" bind_text="bed_mesh_max_label" style_text_color="#text_secondary"/>
              <text_small name="mesh_max_value" bind_text="bed_mesh_max_value" style_text_color="#text_primary"/>
            </lv_obj>
            <!-- Min row -->
            <lv_obj width="100%"
                    height="content" flex_flow="row" style_flex_main_place="space_between" style_bg_opa="0"
                    style_border_width="0" style_pad_all="0" scrollable="false">
              <text_small name="mesh_min_label" bind_text="bed_mesh_min_label" style_text_color="#text_secondary"/>
              <text_small name="mesh_min_value" bind_text="bed_mesh_min_value" style_text_color="#text_primary"/>
            </lv_obj>
            <!-- Range row -->
            <lv_obj width="100%"
                    height="content" flex_flow="row" style_flex_main_place="space_between" style_bg_opa="0"
                    style_border_width="0" style_pad_all="0" scrollable="false">
              <text_small text="Range" style_text_color="#text_secondary"/>
              <text_small name="mesh_range_value" bind_text="bed_mesh_variance" style_text_color="#text_primary"/>
            </lv_obj>
          </lv_obj>
        </lv_obj>
        <!-- ============================================================ -->
        <!-- PROFILES CARD -->
        <!-- ============================================================ -->
        <lv_obj name="profiles_card"
                width="100%" flex_grow="1" style_bg_color="#card_surface" style_bg_opa="255" style_border_width="1"
                style_border_color="#card_border" style_radius="#card_radius" style_pad_all="0" flex_flow="column"
                scrollable="false">
          <!-- Card Header -->
          <lv_obj width="100%"
                  height="content" flex_flow="row" style_flex_cross_place="center" style_bg_opa="0"
                  style_border_width="0" style_pad_left="#space_md" style_pad_right="#space_md"
                  style_pad_top="#space_sm" style_pad_bottom="#space_sm" style_pad_gap="#space_sm" scrollable="false">
            <icon src="layers" size="sm" color="#accent_color"/>
            <text_body text="Profiles" style_text_color="#text_primary" flex_grow="1"/>
          </lv_obj>
          <!-- Divider -->
          <lv_obj width="100%"
                  height="1" style_bg_color="#card_border" style_bg_opa="255" style_border_width="0" scrollable="false"/>
          <!-- Profiles List (scrollable) -->
          <lv_obj name="profiles_list"
                  width="100%" flex_grow="1" flex_flow="column" style_bg_opa="0" style_border_width="0"
                  style_pad_all="#space_sm" style_pad_gap="#space_xs" scrollable="true" scroll_dir="ver">
            <!-- Profile Row 0 -->
            <lv_obj name="profile_row_0"
                    width="100%" height="44" flex_flow="row" style_flex_cross_place="center" style_bg_color="#card_bg"
                    style_bg_opa="255" style_border_width="0" style_radius="#border_radius" style_pad_left="#space_sm"
                    style_pad_right="#space_sm" style_pad_top="0" style_pad_bottom="0" style_pad_gap="#space_xs"
                    clickable="true" scrollable="false">
              <lv_obj-bind_flag_if_lt subject="bed_mesh_profile_count" flag="hidden" ref_value="1"/>
              <event_cb trigger="clicked" callback="on_profile_0_clicked"/>
              <!-- Name -->
              <text_small name="profile_0_name"
                          bind_text="bed_mesh_profile_0_name" flex_grow="1" style_text_color="#text_primary"/>
              <!-- Range -->
              <text_small name="profile_0_range"
                          width="50" bind_text="bed_mesh_profile_0_range" style_text_color="#text_secondary"
                          style_text_align="right"/>
              <!-- Rename icon (only when active) -->
              <icon name="profile_0_rename"
                    src="pencil" size="sm" color="#accent_color" clickable="true" style_pad_all="#space_xs">
                <lv_obj-bind_flag_if_eq subject="bed_mesh_profile_0_active" flag="hidden" ref_value="0"/>
                <event_cb trigger="clicked" callback="on_profile_0_rename"/>
              </icon>
              <!-- Load icon (only when NOT active) -->
              <icon name="profile_0_load"
                    src="download" size="sm" color="#text_secondary" clickable="true" style_pad_all="#space_xs">
                <lv_obj-bind_flag_if_eq subject="bed_mesh_profile_0_active" flag="hidden" ref_value="1"/>
                <event_cb trigger="clicked" callback="on_profile_0_clicked"/>
              </icon>
              <!-- Delete icon (always visible) -->
              <icon name="profile_0_delete"
                    src="trash_can_outline" size="sm" color="#error_color" clickable="true" style_pad_all="#space_xs">
                <event_cb trigger="clicked" callback="on_profile_0_delete"/>
              </icon>
            </lv_obj>
            <!-- Profile Row 1 -->
            <lv_obj name="profile_row_1"
                    width="100%" height="44" flex_flow="row" style_flex_cross_place="center" style_bg_color="#card_bg"
                    style_bg_opa="255" style_border_width="0" style_radius="#border_radius" style_pad_left="#space_sm"
                    style_pad_right="#space_sm" style_pad_top="0" style_pad_bottom="0" style_pad_gap="#space_xs"
                    clickable="true" scrollable="false">
              <lv_obj-bind_flag_if_lt subject="bed_mesh_profile_count" flag="hidden" ref_value="2"/>
              <event_cb trigger="clicked" callback="on_profile_1_clicked"/>
              <text_small name="profile_1_name"
                          bind_text="bed_mesh_profile_1_name" flex_grow="1" style_text_color="#text_primary"/>
              <text_small name="profile_1_range"
                          width="50" bind_text="bed_mesh_profile_1_range" style_text_color="#text_secondary"
                          style_text_align="right"/>
              <icon name="profile_1_rename"
                    src="pencil" size="sm" color="#accent_color" clickable="true" style_pad_all="#space_xs">
                <lv_obj-bind_flag_if_eq subject="bed_mesh_profile_1_active" flag="hidden" ref_value="0"/>
                <event_cb trigger="clicked" callback="on_profile_1_rename"/>
              </icon>
              <icon name="profile_1_load"
                    src="download" size="sm" color="#text_secondary" clickable="true" style_pad_all="#space_xs">
                <lv_obj-bind_flag_if_eq subject="bed_mesh_profile_1_active" flag="hidden" ref_value="1"/>
                <event_cb trigger="clicked" callback="on_profile_1_clicked"/>
              </icon>
              <icon name="profile_1_delete"
                    src="trash_can_outline" size="sm" color="#error_color" clickable="true" style_pad_all="#space_xs">
                <event_cb trigger="clicked" callback="on_profile_1_delete"/>
              </icon>
            </lv_obj>
            <!-- Profile Row 2 -->
            <lv_obj name="profile_row_2"
                    width="100%" height="44" flex_flow="row" style_flex_cross_place="center" style_bg_color="#card_bg"
                    style_bg_opa="255" style_border_width="0" style_radius="#border_radius" style_pad_left="#space_sm"
                    style_pad_right="#space_sm" style_pad_top="0" style_pad_bottom="0" style_pad_gap="#space_xs"
                    clickable="true" scrollable="false">
              <lv_obj-bind_flag_if_lt subject="bed_mesh_profile_count" flag="hidden" ref_value="3"/>
              <event_cb trigger="clicked" callback="on_profile_2_clicked"/>
              <text_small name="profile_2_name"
                          bind_text="bed_mesh_profile_2_name" flex_grow="1" style_text_color="#text_primary"/>
              <text_small name="profile_2_range"
                          width="50" bind_text="bed_mesh_profile_2_range" style_text_color="#text_secondary"
                          style_text_align="right"/>
              <icon name="profile_2_rename"
                    src="pencil" size="sm" color="#accent_color" clickable="true" style_pad_all="#space_xs">
                <lv_obj-bind_flag_if_eq subject="bed_mesh_profile_2_active" flag="hidden" ref_value="0"/>
                <event_cb trigger="clicked" callback="on_profile_2_rename"/>
              </icon>
              <icon name="profile_2_load"
                    src="download" size="sm" color="#text_secondary" clickable="true" style_pad_all="#space_xs">
                <lv_obj-bind_flag_if_eq subject="bed_mesh_profile_2_active" flag="hidden" ref_value="1"/>
                <event_cb trigger="clicked" callback="on_profile_2_clicked"/>
              </icon>
              <icon name="profile_2_delete"
                    src="trash_can_outline" size="sm" color="#error_color" clickable="true" style_pad_all="#space_xs">
                <event_cb trigger="clicked" callback="on_profile_2_delete"/>
              </icon>
            </lv_obj>
            <!-- Profile Row 3 -->
            <lv_obj name="profile_row_3"
                    width="100%" height="44" flex_flow="row" style_flex_cross_place="center" style_bg_color="#card_bg"
                    style_bg_opa="255" style_border_width="0" style_radius="#border_radius" style_pad_left="#space_sm"
                    style_pad_right="#space_sm" style_pad_top="0" style_pad_bottom="0" style_pad_gap="#space_xs"
                    clickable="true" scrollable="false">
              <lv_obj-bind_flag_if_lt subject="bed_mesh_profile_count" flag="hidden" ref_value="4"/>
              <event_cb trigger="clicked" callback="on_profile_3_clicked"/>
              <text_small name="profile_3_name"
                          bind_text="bed_mesh_profile_3_name" flex_grow="1" style_text_color="#text_primary"/>
              <text_small name="profile_3_range"
                          width="50" bind_text="bed_mesh_profile_3_range" style_text_color="#text_secondary"
                          style_text_align="right"/>
              <icon name="profile_3_rename"
                    src="pencil" size="sm" color="#accent_color" clickable="true" style_pad_all="#space_xs">
                <lv_obj-bind_flag_if_eq subject="bed_mesh_profile_3_active" flag="hidden" ref_value="0"/>
                <event_cb trigger="clicked" callback="on_profile_3_rename"/>
              </icon>
              <icon name="profile_3_load"
                    src="download" size="sm" color="#text_secondary" clickable="true" style_pad_all="#space_xs">
                <lv_obj-bind_flag_if_eq subject="bed_mesh_profile_3_active" flag="hidden" ref_value="1"/>
                <event_cb trigger="clicked" callback="on_profile_3_clicked"/>
              </icon>
              <icon name="profile_3_delete"
                    src="trash_can_outline" size="sm" color="#error_color" clickable="true" style_pad_all="#space_xs">
                <event_cb trigger="clicked" callback="on_profile_3_delete"/>
              </icon>
            </lv_obj>
            <!-- Profile Row 4 -->
            <lv_obj name="profile_row_4"
                    width="100%" height="44" flex_flow="row" style_flex_cross_place="center" style_bg_color="#card_bg"
                    style_bg_opa="255" style_border_width="0" style_radius="#border_radius" style_pad_left="#space_sm"
                    style_pad_right="#space_sm" style_pad_top="0" style_pad_bottom="0" style_pad_gap="#space_xs"
                    clickable="true" scrollable="false">
              <lv_obj-bind_flag_if_lt subject="bed_mesh_profile_count" flag="hidden" ref_value="5"/>
              <event_cb trigger="clicked" callback="on_profile_4_clicked"/>
              <text_small name="profile_4_name"
                          bind_text="bed_mesh_profile_4_name" flex_grow="1" style_text_color="#text_primary"/>
              <text_small name="profile_4_range"
                          width="50" bind_text="bed_mesh_profile_4_range" style_text_color="#text_secondary"
                          style_text_align="right"/>
              <icon name="profile_4_rename"
                    src="pencil" size="sm" color="#accent_color" clickable="true" style_pad_all="#space_xs">
                <lv_obj-bind_flag_if_eq subject="bed_mesh_profile_4_active" flag="hidden" ref_value="0"/>
                <event_cb trigger="clicked" callback="on_profile_4_rename"/>
              </icon>
              <icon name="profile_4_load"
                    src="download" size="sm" color="#text_secondary" clickable="true" style_pad_all="#space_xs">
                <lv_obj-bind_flag_if_eq subject="bed_mesh_profile_4_active" flag="hidden" ref_value="1"/>
                <event_cb trigger="clicked" callback="on_profile_4_clicked"/>
              </icon>
              <icon name="profile_4_delete"
                    src="trash_can_outline" size="sm" color="#error_color" clickable="true" style_pad_all="#space_xs">
                <event_cb trigger="clicked" callback="on_profile_4_delete"/>
              </icon>
            </lv_obj>
            <!-- Empty state message (shown when no profiles) -->
            <lv_obj name="no_profiles_message"
                    width="100%" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="#space_md"
                    scrollable="false">
              <lv_obj-bind_flag_if_gt subject="bed_mesh_profile_count" flag="hidden" ref_value="0"/>
              <text_small width="100%"
                          text="No profiles available" style_text_color="#text_secondary" style_text_align="center"/>
            </lv_obj>
          </lv_obj>
        </lv_obj>
      </lv_obj>
    </lv_obj>
  </view>
</component>
