<?xml version="1.0"?>
<!-- Copyright (C) 2025-2026 356C LLC -->
<!-- SPDX-License-Identifier: GPL-3.0-or-later -->
<!-- NOTE: Backdrop created programmatically by Modal system -->
<component>
  <subjects>
    <subject name="hidden_ssid" type="string" value=""/>
    <subject name="hidden_security" type="int" value="1"/>
    <!-- 0=None, 1=WPA/WPA2, 2=WPA3 -->
    <subject name="hidden_password" type="string" value=""/>
    <subject name="hidden_connecting" type="int" value="0"/>
    <subject name="hidden_error" type="string" value=""/>
    <subject name="hidden_show_password" type="int" value="0"/>
    <!-- 0=hide input, 1=show for None -->
  </subjects>
  <!-- Dialog card (backdrop created programmatically) -->
  <view name="hidden_network_modal"
        extends="ui_dialog" width="400" height="content" align="center" flex_flow="column" style_flex_main_place="start"
        style_pad_gap="0">
    <!-- ============================================================ -->
    <!-- STATE: IDLE - Hidden network entry form (hidden when connecting) -->
    <!-- ============================================================ -->
    <lv_obj name="hidden_form_container"
            width="100%" height="content" style_min_height="280" style_bg_opa="0" style_border_width="0"
            style_pad_left="#space_lg" style_pad_right="#space_lg" style_pad_top="#space_lg"
            style_pad_bottom="#space_lg" flex_flow="column" style_flex_cross_place="start" style_pad_gap="#space_md">
      <!-- Hide form when hidden_connecting == 1 -->
      <bind_flag_if_eq subject="hidden_connecting" flag="hidden" ref_value="1"/>
      <!-- Title -->
      <text_heading name="modal_title" width="100%" text="Add Hidden Network" style_text_align="center"/>
      <!-- SSID Input -->
      <lv_obj width="100%"
              height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" flex_flow="column"
              style_pad_gap="#space_xs">
        <text_body width="100%" text="Network Name (SSID)" style_text_align="left"/>
        <lv_textarea name="ssid_input"
                     width="100%" height="#input_height" placeholder="Enter network name" max_length="32"
                     one_line="true" style_border_width="#input_border_width" style_pad_all="#space_md"
                     style_text_font="#font_body"/>
      </lv_obj>
      <!-- Security Dropdown -->
      <lv_obj width="100%"
              height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" flex_flow="column"
              style_pad_gap="#space_xs">
        <text_body width="100%" text="Security" style_text_align="left"/>
        <lv_dropdown name="security_dropdown"
                     width="100%" height="#input_height" options="None WPA/WPA2 WPA3"
                     style_border_width="#input_border_width" style_radius="#border_radius" style_pad_all="#space_md"
                     style_text_font="#font_body">
          <event_cb trigger="value_changed" callback="on_security_changed"/>
        </lv_dropdown>
      </lv_obj>
      <!-- Password Input (hidden when security is None) -->
      <lv_obj name="password_container"
              width="100%" height="content" style_bg_opa="0" style_border_width="0" style_pad_all="0" flex_flow="column"
              style_pad_gap="#space_xs">
        <!-- Hide password field when security == 0 (None) -->
        <bind_flag_if_eq subject="hidden_security" flag="hidden" ref_value="0"/>
        <text_body width="100%" text="Password" style_text_align="left"/>
        <lv_textarea name="password_input"
                     width="100%" height="#input_height" placeholder="Enter password" password_mode="true"
                     max_length="64" one_line="true" style_border_width="#input_border_width" style_pad_all="#space_md"
                     style_text_font="#font_body"/>
      </lv_obj>
      <!-- Error message (hidden when empty) -->
      <text_small name="error_label"
                  width="100%" text="" style_text_align="center" style_text_color="#error_color" hidden="true"/>
    </lv_obj>
    <!-- ============================================================ -->
    <!-- STATE: CONNECTING - Spinner and status (shown when connecting) -->
    <!-- ============================================================ -->
    <lv_obj name="connecting_container"
            width="100%" height="content" style_min_height="280" style_bg_opa="0" style_border_width="0"
            style_pad_left="#space_lg" style_pad_right="#space_lg" style_pad_top="#space_xl"
            style_pad_bottom="#space_xl" flex_flow="column" style_flex_main_place="center"
            style_flex_cross_place="center" style_pad_gap="#space_md" hidden="true">
      <!-- Show spinner when hidden_connecting == 1 -->
      <bind_flag_if_eq subject="hidden_connecting" flag="hidden" ref_value="0"/>
      <spinner size="lg"/>
      <text_heading text="Connecting..." style_text_align="center"/>
      <text_small name="connecting_ssid"
                  bind_text="hidden_ssid" style_text_color="#text_secondary" style_text_align="center"/>
    </lv_obj>
    <!-- Horizontal divider above buttons -->
    <lv_obj width="100%"
            height="1" style_bg_color="#text_secondary" style_bg_opa="64" style_border_width="0" style_pad_all="0"/>
    <!-- ============================================================ -->
    <!-- Button row (edge-to-edge style matching modal_dialog) -->
    <!-- ============================================================ -->
    <lv_obj width="100%"
            height="#button_height" style_bg_opa="0" style_border_width="0" style_pad_all="0" flex_flow="row">
      <!-- Cancel button (always visible) -->
      <lv_button name="cancel_btn"
                 height="100%" flex_grow="1" style_radius="#border_radius" style_border_width="0" style_shadow_width="0"
                 clickable="true">
        <event_cb trigger="clicked" callback="on_hidden_cancel_clicked"/>
        <text_body text="Cancel" align="center"/>
      </lv_button>
      <!-- Vertical divider between buttons (hidden when connecting) -->
      <lv_obj name="btn_divider"
              width="1" height="100%" style_bg_color="#text_secondary" style_bg_opa="64" style_border_width="0"
              style_pad_all="0">
        <!-- Hide divider when hidden_connecting == 1 (connect button hidden) -->
        <bind_flag_if_eq subject="hidden_connecting" flag="hidden" ref_value="1"/>
      </lv_obj>
      <!-- Connect button (hidden while connecting) -->
      <lv_button name="connect_btn"
                 height="100%" flex_grow="1" style_radius="#border_radius" style_border_width="0" style_shadow_width="0"
                 clickable="true">
        <!-- Hide button while connecting (hidden_connecting == 1) -->
        <bind_flag_if_eq subject="hidden_connecting" flag="hidden" ref_value="1"/>
        <event_cb trigger="clicked" callback="on_hidden_connect_clicked"/>
        <text_body text="Connect" align="center"/>
      </lv_button>
    </lv_obj>
  </view>
</component>
