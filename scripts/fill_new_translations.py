#!/usr/bin/env python3
"""Fill in new (empty) translation keys across all language YAML files.

Only touches keys with empty string values — leaves existing translations intact.
Uses line-level replacement to preserve YAML formatting.
"""

import re
import sys
from pathlib import Path

# New translations per language — ONLY for keys that are currently empty
TRANSLATIONS = {
    "de": {
        "0 slots": "0 Slots",
        "AFC abort failed": "AFC-Abbruch fehlgeschlagen",
        "AFC homing complete": "AFC-Referenzfahrt abgeschlossen",
        "AFC homing failed": "AFC-Referenzfahrt fehlgeschlagen",
        "AFC operation aborted": "AFC-Vorgang abgebrochen",
        "AFC recovery complete": "AFC-Wiederherstellung abgeschlossen",
        "AFC recovery failed": "AFC-Wiederherstellung fehlgeschlagen",
        "AMS Management": "AMS-Verwaltung",
        "API not available": "API nicht verfügbar",
        "Abort failed": "Abbruch fehlgeschlagen",
        "Aborting AFC operation...": "AFC-Vorgang wird abgebrochen...",
        "Bypass controlled by hardware sensor": "Bypass wird durch Hardware-Sensor gesteuert",
        "Checking for plugin...": "Prüfe Plugin...",
        "Checking timelapse plugin...": "Prüfe Zeitraffer-Plugin...",
        "Configuration added successfully.": "Konfiguration erfolgreich hinzugefügt.",
        "Configuration already present.": "Konfiguration bereits vorhanden.",
        "Configuring Moonraker...": "Moonraker wird konfiguriert...",
        "Controlled by hardware sensor": "Durch Hardware-Sensor gesteuert",
        "Could not check webcam status.\\nCheck printer connection.": "Webcam-Status konnte nicht geprüft werden.\\nDruckerverbindung prüfen.",
        "Delete Spool?": "Spule löschen?",
        "Edit Spool": "Spule bearbeiten",
        "Failed to delete spool": "Spule konnte nicht gelöscht werden",
        "Failed to download moonraker.conf.\\nCheck printer connection.": "moonraker.conf konnte nicht heruntergeladen werden.\\nDruckerverbindung prüfen.",
        "Failed to restart Moonraker.": "Moonraker konnte nicht neu gestartet werden.",
        "Failed to save spool": "Spule konnte nicht gespeichert werden",
        "Failed to update configuration.\\nCheck printer connection.": "Konfiguration konnte nicht aktualisiert werden.\\nDruckerverbindung prüfen.",
        "Home failed": "Referenzfahrt fehlgeschlagen",
        "Homing AFC system...": "AFC-Referenzfahrt...",
        "Inactive": "Inaktiv",
        "Install the timelapse plugin via SSH,\\nthen tap \"Check Again\".": 'Zeitraffer-Plugin per SSH installieren,\\ndann auf "Erneut prüfen" tippen.',
        "Label printing coming soon": "Etikettendruck kommt bald",
        "Lot/Batch Nr": "Los-/Chargennr.",
        "Moonraker restarting...\\nWaiting for reconnection...": "Moonraker wird neu gestartet...\\nWarte auf Wiederverbindung...",
        "Multi Filament System Overview": "Multi-Filament-System Übersicht",
        "No AMS system connected": "Kein AMS-System verbunden",
        "No presets": "Keine Voreinstellungen",
        "No webcam detected.\\nA webcam is required for timelapse.": "Keine Webcam erkannt.\\nEine Webcam wird für Zeitraffer benötigt.",
        "Notes": "Notizen",
        "On/Off (state-aware)": "Ein/Aus (zustandsbewusst)",
        "Plugin not responding after restart.\\nIt may need more time to load.": "Plugin antwortet nicht nach Neustart.\\nBenötigt möglicherweise mehr Ladezeit.",
        "Price": "Preis",
        "Print Label": "Etikett drucken",
        "Recovering AFC system...": "AFC-Wiederherstellung...",
        "Recovery failed": "Wiederherstellung fehlgeschlagen",
        "Remaining (g)": "Verbleibend (g)",
        "Reset to original values": "Auf Originalwerte zurücksetzen",
        "Restarting Moonraker...": "Moonraker wird neu gestartet...",
        "Searching...": "Suche...",
        "Section Detail": "Abschnittdetails",
        "Set Active": "Aktiv setzen",
        "Spool": "Spule",
        "Spool deleted": "Spule gelöscht",
        "Spool saved": "Spule gespeichert",
        "Spool wt (g)": "Spulengewicht (g)",
        "System": "System",
        "This cannot be undone.": "Dies kann nicht rückgängig gemacht werden.",
        "Timelapse plugin installed successfully!": "Zeitraffer-Plugin erfolgreich installiert!",
        "Timelapse plugin installed!": "Zeitraffer-Plugin installiert!",
        "Timelapse plugin is already installed!": "Zeitraffer-Plugin ist bereits installiert!",
        "Timelapse plugin is installed!": "Zeitraffer-Plugin ist installiert!",
        "Toggle (fire-and-forget)": "Umschalten (fire-and-forget)",
        "Unit": "Einheit",
        "Unit ": "Einheit ",
        "Verifying timelapse plugin...": "Zeitraffer-Plugin wird überprüft...",
        "disabled": "deaktiviert",
        "enabled": "aktiviert",
        "set to": "gesetzt auf",
        "started": "gestartet",
    },
    "es": {
        "0 slots": "0 ranuras",
        "AFC abort failed": "Error al cancelar AFC",
        "AFC homing complete": "Referencia AFC completada",
        "AFC homing failed": "Error en referencia AFC",
        "AFC operation aborted": "Operación AFC cancelada",
        "AFC recovery complete": "Recuperación AFC completada",
        "AFC recovery failed": "Error en recuperación AFC",
        "AMS Management": "Gestión AMS",
        "API not available": "API no disponible",
        "Abort failed": "Error al cancelar",
        "Aborting AFC operation...": "Cancelando operación AFC...",
        "Bypass controlled by hardware sensor": "Bypass controlado por sensor de hardware",
        "Checking for plugin...": "Buscando plugin...",
        "Checking timelapse plugin...": "Verificando plugin de timelapse...",
        "Configuration added successfully.": "Configuración añadida correctamente.",
        "Configuration already present.": "Configuración ya presente.",
        "Configuring Moonraker...": "Configurando Moonraker...",
        "Controlled by hardware sensor": "Controlado por sensor de hardware",
        "Could not check webcam status.\\nCheck printer connection.": "No se pudo verificar la webcam.\\nCompruebe la conexión.",
        "Delete Spool?": "¿Eliminar bobina?",
        "Edit Spool": "Editar bobina",
        "Failed to delete spool": "Error al eliminar bobina",
        "Failed to download moonraker.conf.\\nCheck printer connection.": "Error al descargar moonraker.conf.\\nCompruebe la conexión.",
        "Failed to restart Moonraker.": "Error al reiniciar Moonraker.",
        "Failed to save spool": "Error al guardar bobina",
        "Failed to update configuration.\\nCheck printer connection.": "Error al actualizar configuración.\\nCompruebe la conexión.",
        "Home failed": "Error en referencia",
        "Homing AFC system...": "Referenciando sistema AFC...",
        "Inactive": "Inactivo",
        "Install the timelapse plugin via SSH,\\nthen tap \"Check Again\".": 'Instale el plugin de timelapse vía SSH,\\nluego pulse "Comprobar de nuevo".',
        "Label printing coming soon": "Impresión de etiquetas próximamente",
        "Lot/Batch Nr": "Nº de lote",
        "Moonraker restarting...\\nWaiting for reconnection...": "Reiniciando Moonraker...\\nEsperando reconexión...",
        "Multi Filament System Overview": "Vista general del sistema multi-filamento",
        "No AMS system connected": "Ningún sistema AMS conectado",
        "No presets": "Sin preajustes",
        "No webcam detected.\\nA webcam is required for timelapse.": "No se detectó webcam.\\nSe necesita webcam para timelapse.",
        "Notes": "Notas",
        "On/Off (state-aware)": "On/Off (con estado)",
        "Plugin not responding after restart.\\nIt may need more time to load.": "El plugin no responde tras reiniciar.\\nPuede necesitar más tiempo.",
        "Price": "Precio",
        "Print Label": "Imprimir etiqueta",
        "Recovering AFC system...": "Recuperando sistema AFC...",
        "Recovery failed": "Error en recuperación",
        "Remaining (g)": "Restante (g)",
        "Reset to original values": "Restaurar valores originales",
        "Restarting Moonraker...": "Reiniciando Moonraker...",
        "Searching...": "Buscando...",
        "Section Detail": "Detalle de sección",
        "Set Active": "Establecer activo",
        "Spool": "Bobina",
        "Spool deleted": "Bobina eliminada",
        "Spool saved": "Bobina guardada",
        "Spool wt (g)": "Peso bobina (g)",
        "System": "Sistema",
        "This cannot be undone.": "Esta acción no se puede deshacer.",
        "Timelapse plugin installed successfully!": "¡Plugin de timelapse instalado correctamente!",
        "Timelapse plugin installed!": "¡Plugin de timelapse instalado!",
        "Timelapse plugin is already installed!": "¡El plugin de timelapse ya está instalado!",
        "Timelapse plugin is installed!": "¡El plugin de timelapse está instalado!",
        "Toggle (fire-and-forget)": "Alternar (fire-and-forget)",
        "Unit": "Unidad",
        "Unit ": "Unidad ",
        "Verifying timelapse plugin...": "Verificando plugin de timelapse...",
        "disabled": "desactivado",
        "enabled": "activado",
        "set to": "establecido en",
        "started": "iniciado",
    },
    "fr": {
        "0 slots": "0 emplacements",
        "AFC abort failed": "Échec de l'annulation AFC",
        "AFC homing complete": "Référence AFC terminée",
        "AFC homing failed": "Échec de la référence AFC",
        "AFC operation aborted": "Opération AFC annulée",
        "AFC recovery complete": "Récupération AFC terminée",
        "AFC recovery failed": "Échec de la récupération AFC",
        "AMS Management": "Gestion AMS",
        "API not available": "API non disponible",
        "Abort failed": "Échec de l'annulation",
        "Aborting AFC operation...": "Annulation de l'opération AFC...",
        "Bypass controlled by hardware sensor": "Bypass contrôlé par capteur matériel",
        "Checking for plugin...": "Recherche du plugin...",
        "Checking timelapse plugin...": "Vérification du plugin timelapse...",
        "Configuration added successfully.": "Configuration ajoutée avec succès.",
        "Configuration already present.": "Configuration déjà présente.",
        "Configuring Moonraker...": "Configuration de Moonraker...",
        "Controlled by hardware sensor": "Contrôlé par capteur matériel",
        "Could not check webcam status.\\nCheck printer connection.": "Impossible de vérifier la webcam.\\nVérifiez la connexion.",
        "Delete Spool?": "Supprimer la bobine ?",
        "Edit Spool": "Modifier la bobine",
        "Failed to delete spool": "Échec de la suppression de la bobine",
        "Failed to download moonraker.conf.\\nCheck printer connection.": "Échec du téléchargement de moonraker.conf.\\nVérifiez la connexion.",
        "Failed to restart Moonraker.": "Échec du redémarrage de Moonraker.",
        "Failed to save spool": "Échec de l'enregistrement de la bobine",
        "Failed to update configuration.\\nCheck printer connection.": "Échec de la mise à jour.\\nVérifiez la connexion.",
        "Home failed": "Échec de la référence",
        "Homing AFC system...": "Référence du système AFC...",
        "Inactive": "Inactif",
        "Install the timelapse plugin via SSH,\\nthen tap \"Check Again\".": 'Installez le plugin timelapse via SSH,\\npuis appuyez sur "Revérifier".',
        "Label printing coming soon": "Impression d'étiquettes bientôt disponible",
        "Lot/Batch Nr": "N° de lot",
        "Moonraker restarting...\\nWaiting for reconnection...": "Redémarrage de Moonraker...\\nEn attente de reconnexion...",
        "Multi Filament System Overview": "Vue d'ensemble du système multi-filament",
        "No AMS system connected": "Aucun système AMS connecté",
        "No presets": "Aucun préréglage",
        "No webcam detected.\\nA webcam is required for timelapse.": "Aucune webcam détectée.\\nUne webcam est requise pour le timelapse.",
        "Notes": "Notes",
        "On/Off (state-aware)": "On/Off (avec suivi d'état)",
        "Plugin not responding after restart.\\nIt may need more time to load.": "Le plugin ne répond pas après le redémarrage.\\nIl peut avoir besoin de plus de temps.",
        "Price": "Prix",
        "Print Label": "Imprimer l'étiquette",
        "Recovering AFC system...": "Récupération du système AFC...",
        "Recovery failed": "Échec de la récupération",
        "Remaining (g)": "Restant (g)",
        "Reset to original values": "Réinitialiser aux valeurs d'origine",
        "Restarting Moonraker...": "Redémarrage de Moonraker...",
        "Searching...": "Recherche...",
        "Section Detail": "Détail de section",
        "Set Active": "Définir actif",
        "Spool": "Bobine",
        "Spool deleted": "Bobine supprimée",
        "Spool saved": "Bobine enregistrée",
        "Spool wt (g)": "Poids bobine (g)",
        "System": "Système",
        "This cannot be undone.": "Cette action est irréversible.",
        "Timelapse plugin installed successfully!": "Plugin timelapse installé avec succès !",
        "Timelapse plugin installed!": "Plugin timelapse installé !",
        "Timelapse plugin is already installed!": "Le plugin timelapse est déjà installé !",
        "Timelapse plugin is installed!": "Le plugin timelapse est installé !",
        "Toggle (fire-and-forget)": "Bascule (fire-and-forget)",
        "Unit": "Unité",
        "Unit ": "Unité ",
        "Verifying timelapse plugin...": "Vérification du plugin timelapse...",
        "disabled": "désactivé",
        "enabled": "activé",
        "set to": "réglé à",
        "started": "lancé",
    },
    "it": {
        "0 slots": "0 slot",
        "AFC abort failed": "Annullamento AFC fallito",
        "AFC homing complete": "Homing AFC completato",
        "AFC homing failed": "Homing AFC fallito",
        "AFC operation aborted": "Operazione AFC annullata",
        "AFC recovery complete": "Recupero AFC completato",
        "AFC recovery failed": "Recupero AFC fallito",
        "AMS Management": "Gestione AMS",
        "API not available": "API non disponibile",
        "Abort failed": "Annullamento fallito",
        "Aborting AFC operation...": "Annullamento operazione AFC...",
        "Bypass controlled by hardware sensor": "Bypass controllato da sensore hardware",
        "Checking for plugin...": "Ricerca plugin...",
        "Checking timelapse plugin...": "Verifica plugin timelapse...",
        "Configuration added successfully.": "Configurazione aggiunta con successo.",
        "Configuration already present.": "Configurazione già presente.",
        "Configuring Moonraker...": "Configurazione di Moonraker...",
        "Controlled by hardware sensor": "Controllato da sensore hardware",
        "Could not check webcam status.\\nCheck printer connection.": "Impossibile verificare la webcam.\\nControllare la connessione.",
        "Delete Spool?": "Eliminare bobina?",
        "Edit Spool": "Modifica bobina",
        "Failed to delete spool": "Eliminazione bobina fallita",
        "Failed to download moonraker.conf.\\nCheck printer connection.": "Download di moonraker.conf fallito.\\nControllare la connessione.",
        "Failed to restart Moonraker.": "Riavvio di Moonraker fallito.",
        "Failed to save spool": "Salvataggio bobina fallito",
        "Failed to update configuration.\\nCheck printer connection.": "Aggiornamento configurazione fallito.\\nControllare la connessione.",
        "Home failed": "Homing fallito",
        "Homing AFC system...": "Homing sistema AFC...",
        "Inactive": "Inattivo",
        "Install the timelapse plugin via SSH,\\nthen tap \"Check Again\".": 'Installare il plugin timelapse via SSH,\\npoi toccare "Ricontrolla".',
        "Label printing coming soon": "Stampa etichette in arrivo",
        "Lot/Batch Nr": "Nr. lotto",
        "Moonraker restarting...\\nWaiting for reconnection...": "Riavvio di Moonraker...\\nIn attesa di riconnessione...",
        "Multi Filament System Overview": "Panoramica sistema multi-filamento",
        "No AMS system connected": "Nessun sistema AMS connesso",
        "No presets": "Nessun preset",
        "No webcam detected.\\nA webcam is required for timelapse.": "Nessuna webcam rilevata.\\nWebcam necessaria per il timelapse.",
        "Notes": "Note",
        "On/Off (state-aware)": "On/Off (con stato)",
        "Plugin not responding after restart.\\nIt may need more time to load.": "Il plugin non risponde dopo il riavvio.\\nPotrebbe servire più tempo.",
        "Price": "Prezzo",
        "Print Label": "Stampa etichetta",
        "Recovering AFC system...": "Recupero sistema AFC...",
        "Recovery failed": "Recupero fallito",
        "Remaining (g)": "Rimanente (g)",
        "Reset to original values": "Ripristina valori originali",
        "Restarting Moonraker...": "Riavvio di Moonraker...",
        "Searching...": "Ricerca...",
        "Section Detail": "Dettaglio sezione",
        "Set Active": "Imposta attivo",
        "Spool": "Bobina",
        "Spool deleted": "Bobina eliminata",
        "Spool saved": "Bobina salvata",
        "Spool wt (g)": "Peso bobina (g)",
        "System": "Sistema",
        "This cannot be undone.": "Questa azione non può essere annullata.",
        "Timelapse plugin installed successfully!": "Plugin timelapse installato con successo!",
        "Timelapse plugin installed!": "Plugin timelapse installato!",
        "Timelapse plugin is already installed!": "Il plugin timelapse è già installato!",
        "Timelapse plugin is installed!": "Il plugin timelapse è installato!",
        "Toggle (fire-and-forget)": "Interruttore (fire-and-forget)",
        "Unit": "Unità",
        "Unit ": "Unità ",
        "Verifying timelapse plugin...": "Verifica del plugin timelapse...",
        "disabled": "disattivato",
        "enabled": "attivato",
        "set to": "impostato a",
        "started": "avviato",
    },
    "ja": {
        "0 slots": "0 スロット",
        "AFC abort failed": "AFC中断に失敗",
        "AFC homing complete": "AFCホーミング完了",
        "AFC homing failed": "AFCホーミング失敗",
        "AFC operation aborted": "AFC操作を中断しました",
        "AFC recovery complete": "AFCリカバリー完了",
        "AFC recovery failed": "AFCリカバリー失敗",
        "AMS Management": "AMS管理",
        "API not available": "APIが利用できません",
        "Abort failed": "中断に失敗",
        "Aborting AFC operation...": "AFC操作を中断中...",
        "Bypass controlled by hardware sensor": "ハードウェアセンサーによるバイパス制御",
        "Checking for plugin...": "プラグインを確認中...",
        "Checking timelapse plugin...": "タイムラプスプラグインを確認中...",
        "Configuration added successfully.": "設定を追加しました。",
        "Configuration already present.": "設定は既に存在します。",
        "Configuring Moonraker...": "Moonrakerを設定中...",
        "Controlled by hardware sensor": "ハードウェアセンサー制御",
        "Could not check webcam status.\\nCheck printer connection.": "カメラ状態を確認できません。\\n接続を確認してください。",
        "Delete Spool?": "スプールを削除しますか？",
        "Edit Spool": "スプールを編集",
        "Failed to delete spool": "スプールの削除に失敗",
        "Failed to download moonraker.conf.\\nCheck printer connection.": "moonraker.confのダウンロードに失敗。\\n接続を確認してください。",
        "Failed to restart Moonraker.": "Moonrakerの再起動に失敗。",
        "Failed to save spool": "スプールの保存に失敗",
        "Failed to update configuration.\\nCheck printer connection.": "設定の更新に失敗。\\n接続を確認してください。",
        "Home failed": "ホーミング失敗",
        "Homing AFC system...": "AFCシステムをホーミング中...",
        "Inactive": "非アクティブ",
        "Install the timelapse plugin via SSH,\\nthen tap \"Check Again\".": 'SSHでタイムラプスプラグインをインストールし、\\n「再確認」をタップしてください。',
        "Label printing coming soon": "ラベル印刷は近日対応予定",
        "Lot/Batch Nr": "ロット番号",
        "Moonraker restarting...\\nWaiting for reconnection...": "Moonraker再起動中...\\n再接続を待っています...",
        "Multi Filament System Overview": "マルチフィラメントシステム概要",
        "No AMS system connected": "AMSシステム未接続",
        "No presets": "プリセットなし",
        "No webcam detected.\\nA webcam is required for timelapse.": "カメラが検出されません。\\nタイムラプスにはカメラが必要です。",
        "Notes": "メモ",
        "On/Off (state-aware)": "オン/オフ（状態追跡）",
        "Plugin not responding after restart.\\nIt may need more time to load.": "再起動後プラグインが応答しません。\\n読み込みに時間がかかっている可能性があります。",
        "Price": "価格",
        "Print Label": "ラベル印刷",
        "Recovering AFC system...": "AFCシステムをリカバリー中...",
        "Recovery failed": "リカバリー失敗",
        "Remaining (g)": "残量 (g)",
        "Reset to original values": "元の値にリセット",
        "Restarting Moonraker...": "Moonrakerを再起動中...",
        "Searching...": "検索中...",
        "Section Detail": "セクション詳細",
        "Set Active": "アクティブに設定",
        "Spool": "スプール",
        "Spool deleted": "スプールを削除しました",
        "Spool saved": "スプールを保存しました",
        "Spool wt (g)": "スプール重量 (g)",
        "System": "システム",
        "This cannot be undone.": "この操作は元に戻せません。",
        "Timelapse plugin installed successfully!": "タイムラプスプラグインのインストール完了！",
        "Timelapse plugin installed!": "タイムラプスプラグインをインストールしました！",
        "Timelapse plugin is already installed!": "タイムラプスプラグインは既にインストール済みです！",
        "Timelapse plugin is installed!": "タイムラプスプラグインがインストールされています！",
        "Toggle (fire-and-forget)": "トグル（fire-and-forget）",
        "Unit": "ユニット",
        "Unit ": "ユニット ",
        "Verifying timelapse plugin...": "タイムラプスプラグインを検証中...",
        "disabled": "無効",
        "enabled": "有効",
        "set to": "に設定",
        "started": "開始",
    },
    "pt": {
        "0 slots": "0 slots",
        "AFC abort failed": "Falha ao cancelar AFC",
        "AFC homing complete": "Referência AFC concluída",
        "AFC homing failed": "Falha na referência AFC",
        "AFC operation aborted": "Operação AFC cancelada",
        "AFC recovery complete": "Recuperação AFC concluída",
        "AFC recovery failed": "Falha na recuperação AFC",
        "AMS Management": "Gestão AMS",
        "API not available": "API não disponível",
        "Abort failed": "Falha ao cancelar",
        "Aborting AFC operation...": "Cancelando operação AFC...",
        "Bypass controlled by hardware sensor": "Bypass controlado por sensor de hardware",
        "Checking for plugin...": "Verificando plugin...",
        "Checking timelapse plugin...": "Verificando plugin de timelapse...",
        "Configuration added successfully.": "Configuração adicionada com sucesso.",
        "Configuration already present.": "Configuração já presente.",
        "Configuring Moonraker...": "Configurando Moonraker...",
        "Controlled by hardware sensor": "Controlado por sensor de hardware",
        "Could not check webcam status.\\nCheck printer connection.": "Não foi possível verificar a webcam.\\nVerifique a conexão.",
        "Delete Spool?": "Excluir bobina?",
        "Edit Spool": "Editar bobina",
        "Failed to delete spool": "Falha ao excluir bobina",
        "Failed to download moonraker.conf.\\nCheck printer connection.": "Falha ao baixar moonraker.conf.\\nVerifique a conexão.",
        "Failed to restart Moonraker.": "Falha ao reiniciar Moonraker.",
        "Failed to save spool": "Falha ao salvar bobina",
        "Failed to update configuration.\\nCheck printer connection.": "Falha ao atualizar configuração.\\nVerifique a conexão.",
        "Home failed": "Falha na referência",
        "Homing AFC system...": "Referenciando sistema AFC...",
        "Inactive": "Inativo",
        "Install the timelapse plugin via SSH,\\nthen tap \"Check Again\".": 'Instale o plugin de timelapse via SSH,\\ndepois toque em "Verificar novamente".',
        "Label printing coming soon": "Impressão de etiquetas em breve",
        "Lot/Batch Nr": "Nº do lote",
        "Moonraker restarting...\\nWaiting for reconnection...": "Reiniciando Moonraker...\\nAguardando reconexão...",
        "Multi Filament System Overview": "Visão geral do sistema multi-filamento",
        "No AMS system connected": "Nenhum sistema AMS conectado",
        "No presets": "Sem predefinições",
        "No webcam detected.\\nA webcam is required for timelapse.": "Nenhuma webcam detectada.\\nWebcam necessária para timelapse.",
        "Notes": "Notas",
        "On/Off (state-aware)": "On/Off (com estado)",
        "Plugin not responding after restart.\\nIt may need more time to load.": "Plugin não responde após reiniciar.\\nPode precisar de mais tempo.",
        "Price": "Preço",
        "Print Label": "Imprimir etiqueta",
        "Recovering AFC system...": "Recuperando sistema AFC...",
        "Recovery failed": "Falha na recuperação",
        "Remaining (g)": "Restante (g)",
        "Reset to original values": "Restaurar valores originais",
        "Restarting Moonraker...": "Reiniciando Moonraker...",
        "Searching...": "Pesquisando...",
        "Section Detail": "Detalhe da seção",
        "Set Active": "Definir ativo",
        "Spool": "Bobina",
        "Spool deleted": "Bobina excluída",
        "Spool saved": "Bobina salva",
        "Spool wt (g)": "Peso bobina (g)",
        "System": "Sistema",
        "This cannot be undone.": "Esta ação não pode ser desfeita.",
        "Timelapse plugin installed successfully!": "Plugin de timelapse instalado com sucesso!",
        "Timelapse plugin installed!": "Plugin de timelapse instalado!",
        "Timelapse plugin is already installed!": "O plugin de timelapse já está instalado!",
        "Timelapse plugin is installed!": "O plugin de timelapse está instalado!",
        "Toggle (fire-and-forget)": "Alternar (fire-and-forget)",
        "Unit": "Unidade",
        "Unit ": "Unidade ",
        "Verifying timelapse plugin...": "Verificando plugin de timelapse...",
        "disabled": "desativado",
        "enabled": "ativado",
        "set to": "definido para",
        "started": "iniciado",
    },
    "ru": {
        "0 slots": "0 слотов",
        "AFC abort failed": "Ошибка отмены AFC",
        "AFC homing complete": "Парковка AFC завершена",
        "AFC homing failed": "Ошибка парковки AFC",
        "AFC operation aborted": "Операция AFC отменена",
        "AFC recovery complete": "Восстановление AFC завершено",
        "AFC recovery failed": "Ошибка восстановления AFC",
        "AMS Management": "Управление AMS",
        "API not available": "API недоступен",
        "Abort failed": "Ошибка отмены",
        "Aborting AFC operation...": "Отмена операции AFC...",
        "Bypass controlled by hardware sensor": "Байпас управляется аппаратным датчиком",
        "Checking for plugin...": "Проверка плагина...",
        "Checking timelapse plugin...": "Проверка плагина таймлапс...",
        "Configuration added successfully.": "Конфигурация успешно добавлена.",
        "Configuration already present.": "Конфигурация уже существует.",
        "Configuring Moonraker...": "Настройка Moonraker...",
        "Controlled by hardware sensor": "Управляется аппаратным датчиком",
        "Could not check webcam status.\\nCheck printer connection.": "Не удалось проверить веб-камеру.\\nПроверьте подключение.",
        "Delete Spool?": "Удалить катушку?",
        "Edit Spool": "Редактировать катушку",
        "Failed to delete spool": "Ошибка удаления катушки",
        "Failed to download moonraker.conf.\\nCheck printer connection.": "Ошибка загрузки moonraker.conf.\\nПроверьте подключение.",
        "Failed to restart Moonraker.": "Ошибка перезапуска Moonraker.",
        "Failed to save spool": "Ошибка сохранения катушки",
        "Failed to update configuration.\\nCheck printer connection.": "Ошибка обновления конфигурации.\\nПроверьте подключение.",
        "Home failed": "Ошибка парковки",
        "Homing AFC system...": "Парковка системы AFC...",
        "Inactive": "Неактивно",
        "Install the timelapse plugin via SSH,\\nthen tap \"Check Again\".": 'Установите плагин таймлапс через SSH,\\nзатем нажмите "Проверить снова".',
        "Label printing coming soon": "Печать этикеток скоро будет доступна",
        "Lot/Batch Nr": "№ партии",
        "Moonraker restarting...\\nWaiting for reconnection...": "Перезапуск Moonraker...\\nОжидание переподключения...",
        "Multi Filament System Overview": "Обзор мультифиламентной системы",
        "No AMS system connected": "Система AMS не подключена",
        "No presets": "Нет пресетов",
        "No webcam detected.\\nA webcam is required for timelapse.": "Веб-камера не обнаружена.\\nДля таймлапс необходима веб-камера.",
        "Notes": "Заметки",
        "On/Off (state-aware)": "Вкл/Выкл (с отслеживанием)",
        "Plugin not responding after restart.\\nIt may need more time to load.": "Плагин не отвечает после перезапуска.\\nВозможно, требуется больше времени.",
        "Price": "Цена",
        "Print Label": "Печать этикетки",
        "Recovering AFC system...": "Восстановление системы AFC...",
        "Recovery failed": "Ошибка восстановления",
        "Remaining (g)": "Остаток (г)",
        "Reset to original values": "Сбросить к исходным значениям",
        "Restarting Moonraker...": "Перезапуск Moonraker...",
        "Searching...": "Поиск...",
        "Section Detail": "Детали раздела",
        "Set Active": "Сделать активной",
        "Spool": "Катушка",
        "Spool deleted": "Катушка удалена",
        "Spool saved": "Катушка сохранена",
        "Spool wt (g)": "Вес катушки (г)",
        "System": "Система",
        "This cannot be undone.": "Это действие нельзя отменить.",
        "Timelapse plugin installed successfully!": "Плагин таймлапс успешно установлен!",
        "Timelapse plugin installed!": "Плагин таймлапс установлен!",
        "Timelapse plugin is already installed!": "Плагин таймлапс уже установлен!",
        "Timelapse plugin is installed!": "Плагин таймлапс установлен!",
        "Toggle (fire-and-forget)": "Переключатель (fire-and-forget)",
        "Unit": "Блок",
        "Unit ": "Блок ",
        "Verifying timelapse plugin...": "Проверка плагина таймлапс...",
        "disabled": "отключено",
        "enabled": "включено",
        "set to": "установлено на",
        "started": "запущено",
    },
    "zh": {
        "0 slots": "0 个插槽",
        "AFC abort failed": "AFC中止失败",
        "AFC homing complete": "AFC归位完成",
        "AFC homing failed": "AFC归位失败",
        "AFC operation aborted": "AFC操作已中止",
        "AFC recovery complete": "AFC恢复完成",
        "AFC recovery failed": "AFC恢复失败",
        "AMS Management": "AMS管理",
        "API not available": "API不可用",
        "Abort failed": "中止失败",
        "Aborting AFC operation...": "正在中止AFC操作...",
        "Bypass controlled by hardware sensor": "旁路由硬件传感器控制",
        "Checking for plugin...": "正在检查插件...",
        "Checking timelapse plugin...": "正在检查延时摄影插件...",
        "Configuration added successfully.": "配置添加成功。",
        "Configuration already present.": "配置已存在。",
        "Configuring Moonraker...": "正在配置Moonraker...",
        "Controlled by hardware sensor": "由硬件传感器控制",
        "Could not check webcam status.\\nCheck printer connection.": "无法检查摄像头状态。\\n请检查打印机连接。",
        "Delete Spool?": "删除料盘？",
        "Edit Spool": "编辑料盘",
        "Failed to delete spool": "删除料盘失败",
        "Failed to download moonraker.conf.\\nCheck printer connection.": "下载moonraker.conf失败。\\n请检查连接。",
        "Failed to restart Moonraker.": "重启Moonraker失败。",
        "Failed to save spool": "保存料盘失败",
        "Failed to update configuration.\\nCheck printer connection.": "更新配置失败。\\n请检查连接。",
        "Home failed": "归位失败",
        "Homing AFC system...": "正在归位AFC系统...",
        "Inactive": "未激活",
        "Install the timelapse plugin via SSH,\\nthen tap \"Check Again\".": '通过SSH安装延时摄影插件，\\n然后点击"重新检查"。',
        "Label printing coming soon": "标签打印即将推出",
        "Lot/Batch Nr": "批次号",
        "Moonraker restarting...\\nWaiting for reconnection...": "Moonraker重启中...\\n等待重新连接...",
        "Multi Filament System Overview": "多耗材系统概览",
        "No AMS system connected": "未连接AMS系统",
        "No presets": "无预设",
        "No webcam detected.\\nA webcam is required for timelapse.": "未检测到摄像头。\\n延时摄影需要摄像头。",
        "Notes": "备注",
        "On/Off (state-aware)": "开/关（状态感知）",
        "Plugin not responding after restart.\\nIt may need more time to load.": "重启后插件无响应。\\n可能需要更多加载时间。",
        "Price": "价格",
        "Print Label": "打印标签",
        "Recovering AFC system...": "正在恢复AFC系统...",
        "Recovery failed": "恢复失败",
        "Remaining (g)": "剩余 (g)",
        "Reset to original values": "恢复原始值",
        "Restarting Moonraker...": "正在重启Moonraker...",
        "Searching...": "搜索中...",
        "Section Detail": "区域详情",
        "Set Active": "设为活动",
        "Spool": "料盘",
        "Spool deleted": "料盘已删除",
        "Spool saved": "料盘已保存",
        "Spool wt (g)": "料盘重量 (g)",
        "System": "系统",
        "This cannot be undone.": "此操作无法撤销。",
        "Timelapse plugin installed successfully!": "延时摄影插件安装成功！",
        "Timelapse plugin installed!": "延时摄影插件已安装！",
        "Timelapse plugin is already installed!": "延时摄影插件已安装！",
        "Timelapse plugin is installed!": "延时摄影插件已安装！",
        "Toggle (fire-and-forget)": "切换（即发即忘）",
        "Unit": "单元",
        "Unit ": "单元 ",
        "Verifying timelapse plugin...": "正在验证延时摄影插件...",
        "disabled": "已禁用",
        "enabled": "已启用",
        "set to": "设置为",
        "started": "已启动",
    },
}


def yaml_escape(value: str) -> str:
    """Escape a value for safe YAML inline string representation."""
    # If it contains single quotes, use double-quote wrapping
    if "'" in value:
        # Escape any double quotes inside
        escaped = value.replace("\\", "\\\\").replace('"', '\\"')
        return f'"{escaped}"'
    # Otherwise use single quotes (standard in these files)
    return f"'{value}'"


def fill_translations(yaml_dir: Path):
    """Fill empty translation values using line-level replacement."""
    for lang, trans_map in TRANSLATIONS.items():
        filepath = yaml_dir / f"{lang}.yml"
        if not filepath.exists():
            print(f"  SKIP {lang}.yml (not found)")
            continue

        with open(filepath, "r", encoding="utf-8") as f:
            lines = f.readlines()

        filled = 0
        new_lines = []
        for line in lines:
            # Match lines like "  key: ''" (empty single-quoted value)
            # The YAML files use 2-space indent under "translations:"
            match = re.match(r"^(\s+)(.*?):\s*''\s*$", line)
            if match:
                indent = match.group(1)
                key = match.group(2)
                # Remove surrounding quotes from key if present
                if key.startswith("'") and key.endswith("'"):
                    key = key[1:-1]
                elif key.startswith('"') and key.endswith('"'):
                    key = key[1:-1]

                # Normalize key: YAML unquoted values preserve \" literally,
                # but Python dict keys use just " (since \" in Python = ")
                normalized_key = key.replace('\\"', '"')
                lookup_key = key if key in trans_map else normalized_key
                if lookup_key in trans_map and trans_map[lookup_key]:
                    new_val = yaml_escape(trans_map[lookup_key])
                    new_lines.append(f"{indent}{match.group(2)}: {new_val}\n")
                    filled += 1
                    continue

            new_lines.append(line)

        with open(filepath, "w", encoding="utf-8") as f:
            f.writelines(new_lines)

        print(f"  {lang}.yml: {filled} keys translated")


if __name__ == "__main__":
    yaml_dir = Path(__file__).parent.parent / "translations"
    print(f"Filling new translations in {yaml_dir}")
    fill_translations(yaml_dir)
    print("Done!")
